import{t as P,_ as L,c as U}from"./Tag.js";import{aH as H,bY as K,bZ as N,aI as W,k as B,d as $,h as o,a6 as E,N as M,w as Y,aC as Z,r as v,x as j,C as q,j as S,H as G,L as J,O as A}from"./popup/popup.js";import{_ as Q,u as X}from"./Input.js";import{A as ee}from"./Scrollbar.js";import{s as te,_ as ne}from"./Space.js";import{b as se}from"./DescriptionsItem.js";function ae(t){switch(t){case"tiny":return"mini";case"small":return"tiny";case"medium":return"small";case"large":return"medium";case"huge":return"large"}throw new Error(`${t} has no smaller size.`)}const ie=H({name:"DynamicTags",common:W,peers:{Input:N,Button:K,Tag:P,Space:te},self(){return{inputWidth:"64px"}}}),le=B("dynamic-tags",[B("input",{minWidth:"var(--n-input-width)"})]),re=Object.assign(Object.assign(Object.assign({},j.props),U),{size:{type:String,default:"medium"},closable:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[]},value:Array,inputClass:String,inputStyle:[String,Object],inputProps:Object,max:Number,tagClass:String,tagStyle:[String,Object],renderTag:Function,onCreate:{type:Function,default:t=>t},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),ge=$({name:"DynamicTags",props:re,slots:Object,setup(t){const{mergedClsPrefixRef:y,inlineThemeDisabled:c}=Y(t),{localeRef:d}=X("DynamicTags"),m=Z(t),{mergedDisabledRef:a}=m,p=v(""),g=v(!1),h=v(!0),C=v(null),b=j("DynamicTags","-dynamic-tags",le,ie,t,y),T=v(t.defaultValue),O=q(t,"value"),l=se(O,T),V=S(()=>d.value.add),F=S(()=>ae(t.size)),w=S(()=>a.value||!!t.max&&l.value.length>=t.max);function _(e){const{onChange:n,"onUpdate:value":s,onUpdateValue:u}=t,{nTriggerFormInput:k,nTriggerFormChange:x}=m;n&&A(n,e),u&&A(u,e),s&&A(s,e),T.value=e,k(),x()}function I(e){const n=l.value.slice(0);n.splice(e,1),_(n)}function z(e){switch(e.key){case"Enter":r()}}function r(e){const n=e??p.value;if(n){const s=l.value.slice(0);s.push(t.onCreate(n)),_(s)}g.value=!1,h.value=!0,p.value=""}function D(){r()}function R(){g.value=!0,J(()=>{var e;(e=C.value)===null||e===void 0||e.focus(),h.value=!1})}const f=S(()=>{const{self:{inputWidth:e}}=b.value;return{"--n-input-width":e}}),i=c?G("dynamic-tags",void 0,f,t):void 0;return{mergedClsPrefix:y,inputInstRef:C,localizedAdd:V,inputSize:F,inputValue:p,showInput:g,inputForceFocused:h,mergedValue:l,mergedDisabled:a,triggerDisabled:w,handleInputKeyDown:z,handleAddClick:R,handleInputBlur:D,handleCloseClick:I,handleInputConfirm:r,mergedTheme:b,cssVars:c?void 0:f,themeClass:i==null?void 0:i.themeClass,onRender:i==null?void 0:i.onRender}},render(){const{mergedTheme:t,cssVars:y,mergedClsPrefix:c,onRender:d,renderTag:m}=this;return d==null||d(),o(ne,{class:[`${c}-dynamic-tags`,this.themeClass],size:"small",style:y,theme:t.peers.Space,themeOverrides:t.peerOverrides.Space,itemStyle:"display: flex;"},{default:()=>{const{mergedTheme:a,tagClass:p,tagStyle:g,type:h,round:C,size:b,color:T,closable:O,mergedDisabled:l,showInput:V,inputValue:F,inputClass:w,inputStyle:_,inputSize:I,inputForceFocused:z,triggerDisabled:r,handleInputKeyDown:D,handleInputBlur:R,handleAddClick:f,handleCloseClick:i,handleInputConfirm:e,$slots:n}=this;return this.mergedValue.map((s,u)=>m?m(s,u):o(L,{key:u,theme:a.peers.Tag,themeOverrides:a.peerOverrides.Tag,class:p,style:g,type:h,round:C,size:b,color:T,closable:O,disabled:l,onClose:()=>{i(u)}},{default:()=>typeof s=="string"?s:s.label})).concat(V?n.input?n.input({submit:e,deactivate:R}):o(Q,Object.assign({placeholder:"",size:I,style:_,class:w,autosize:!0},this.inputProps,{ref:"inputInstRef",value:F,onUpdateValue:s=>{this.inputValue=s},theme:a.peers.Input,themeOverrides:a.peerOverrides.Input,onKeydown:D,onBlur:R,internalForceFocus:z})):n.trigger?n.trigger({activate:f,disabled:r}):o(E,{dashed:!0,disabled:r,theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:I,onClick:f},{icon:()=>o(M,{clsPrefix:c},{default:()=>o(ee,null)})}))}})}});export{ge as _};
