(function(){"use strict";function ne(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var j={exports:{}},ae=j.exports,V;function le(){return V||(V=1,(function(a,e){(function(t,s){s(a)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:ae,function(t){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)t.exports=globalThis.browser;else{const s="The message port closed before a response was received.",o=i=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(n).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class l extends WeakMap{constructor(p,w=void 0){super(w),this.createItem=p}get(p){return this.has(p)||this.set(p,this.createItem(p)),super.get(p)}}const u=d=>d&&typeof d=="object"&&typeof d.then=="function",S=(d,p)=>(...w)=>{i.runtime.lastError?d.reject(new Error(i.runtime.lastError.message)):p.singleCallbackArg||w.length<=1&&p.singleCallbackArg!==!1?d.resolve(w[0]):d.resolve(w)},b=d=>d==1?"argument":"arguments",M=(d,p)=>function(C,...k){if(k.length<p.minArgs)throw new Error(`Expected at least ${p.minArgs} ${b(p.minArgs)} for ${d}(), got ${k.length}`);if(k.length>p.maxArgs)throw new Error(`Expected at most ${p.maxArgs} ${b(p.maxArgs)} for ${d}(), got ${k.length}`);return new Promise((P,I)=>{if(p.fallbackToNoCallback)try{C[d](...k,S({resolve:P,reject:I},p))}catch(f){console.warn(`${d} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,f),C[d](...k),p.fallbackToNoCallback=!1,p.noCallback=!0,P()}else p.noCallback?(C[d](...k),P()):C[d](...k,S({resolve:P,reject:I},p))})},g=(d,p,w)=>new Proxy(p,{apply(C,k,P){return w.call(k,d,...P)}});let v=Function.call.bind(Object.prototype.hasOwnProperty);const E=(d,p={},w={})=>{let C=Object.create(null),k={has(I,f){return f in d||f in C},get(I,f,_){if(f in C)return C[f];if(!(f in d))return;let A=d[f];if(typeof A=="function")if(typeof p[f]=="function")A=g(d,d[f],p[f]);else if(v(w,f)){let F=M(f,w[f]);A=g(d,d[f],F)}else A=A.bind(d);else if(typeof A=="object"&&A!==null&&(v(p,f)||v(w,f)))A=E(A,p[f],w[f]);else if(v(w,"*"))A=E(A,p[f],w["*"]);else return Object.defineProperty(C,f,{configurable:!0,enumerable:!0,get(){return d[f]},set(F){d[f]=F}}),A;return C[f]=A,A},set(I,f,_,A){return f in C?C[f]=_:d[f]=_,!0},defineProperty(I,f,_){return Reflect.defineProperty(C,f,_)},deleteProperty(I,f){return Reflect.deleteProperty(C,f)}},P=Object.create(d);return new Proxy(P,k)},T=d=>({addListener(p,w,...C){p.addListener(d.get(w),...C)},hasListener(p,w){return p.hasListener(d.get(w))},removeListener(p,w){p.removeListener(d.get(w))}}),N=new l(d=>typeof d!="function"?d:function(w){const C=E(w,{},{getContent:{minArgs:0,maxArgs:0}});d(C)}),L=new l(d=>typeof d!="function"?d:function(w,C,k){let P=!1,I,f=new Promise(B=>{I=function(D){P=!0,B(D)}}),_;try{_=d(w,C,I)}catch(B){_=Promise.reject(B)}const A=_!==!0&&u(_);if(_!==!0&&!A&&!P)return!1;const F=B=>{B.then(D=>{k(D)},D=>{let Y;D&&(D instanceof Error||typeof D.message=="string")?Y=D.message:Y="An unexpected error occurred",k({__mozWebExtensionPolyfillReject__:!0,message:Y})}).catch(D=>{console.error("Failed to send onMessage rejected reply",D)})};return F(A?_:f),!0}),O=({reject:d,resolve:p},w)=>{i.runtime.lastError?i.runtime.lastError.message===s?p():d(new Error(i.runtime.lastError.message)):w&&w.__mozWebExtensionPolyfillReject__?d(new Error(w.message)):p(w)},ie=(d,p,w,...C)=>{if(C.length<p.minArgs)throw new Error(`Expected at least ${p.minArgs} ${b(p.minArgs)} for ${d}(), got ${C.length}`);if(C.length>p.maxArgs)throw new Error(`Expected at most ${p.maxArgs} ${b(p.maxArgs)} for ${d}(), got ${C.length}`);return new Promise((k,P)=>{const I=O.bind(null,{resolve:k,reject:P});C.push(I),w.sendMessage(...C)})},ke={devtools:{network:{onRequestFinished:T(N)}},runtime:{onMessage:T(L),onMessageExternal:T(L),sendMessage:ie.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:ie.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},$={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":$},services:{"*":$},websites:{"*":$}},E(i,ke,n)};t.exports=o(chrome)}})})(j)),j.exports}var ce=le();const c=ne(ce);class ue{constructor(){this.maxLogs=1e3,this.storageKey="autoSwiper_logs",this.context=this.detectContext(),this.version=null,this.logs=[],this.init()}async init(){try{const e=c.runtime.getManifest();this.version=e.version,await this.loadLogs()}catch(e){console.error("Logger initialization failed:",e),this.version="unknown"}}detectContext(){try{return typeof window<"u"&&window.location?"content":typeof document<"u"?"popup":"background"}catch{return"unknown"}}formatLogEntry(e,t,s={}){const o={timestamp:Date.now(),level:e,message:t,context:this.context,data:s,version:this.version};return this.context==="content"&&typeof window<"u"&&window.location&&(o.url=window.location.href),o}outputToConsole(e){const s=`[${new Date(e.timestamp).toISOString().substr(11,12)}] [${e.context}] [${e.level.toUpperCase()}]`,o=e.data&&Object.keys(e.data).length>0;switch(e.level){case"error":console.error(s,e.message,o?e.data:"");break;case"warn":console.warn(s,e.message,o?e.data:"");break;case"debug":console.debug(s,e.message,o?e.data:"");break;default:console.log(s,e.message,o?e.data:"")}}sanitizeData(e){if(!e||typeof e!="object")return e;const t={...e},s=["token","password","key","secret","auth","api_key","apikey"];for(const o in t){const i=o.toLowerCase();s.some(n=>i.includes(n))&&(t[o]="[REDACTED]")}return t}async addLog(e,t,s={}){try{const o=this.sanitizeData(s),i=this.formatLogEntry(e,t,o);this.outputToConsole(i),this.logs.push(i),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs)),this.saveLogs().catch(n=>{n.message&&n.message.includes("Extension context invalidated")||console.error("Failed to save logs:",n)})}catch(o){console.error("Logger.addLog failed:",o)}}info(e,t={}){this.addLog("info",e,t)}warn(e,t={}){this.addLog("warn",e,t)}error(e,t={}){this.addLog("error",e,t)}debug(e,t={}){this.addLog("debug",e,t)}async loadLogs(){try{const t=(await c.storage.local.get(this.storageKey))[this.storageKey];return Array.isArray(t)?this.logs=t:this.logs=[],this.logs}catch(e){return e.message&&e.message.includes("Extension context invalidated")?(this.logs=[],this.logs):(console.error("Failed to load logs from storage:",e),this.logs=[],this.logs)}}async saveLogs(){try{await c.storage.local.set({[this.storageKey]:this.logs})}catch(e){if(e.message&&e.message.includes("Extension context invalidated"))return;if(console.error("Failed to save logs to storage:",e),e.message&&e.message.includes("QUOTA_BYTES")){this.logs=this.logs.slice(-Math.floor(this.maxLogs/2));try{await c.storage.local.set({[this.storageKey]:this.logs})}catch(t){if(t.message&&t.message.includes("Extension context invalidated"))return;console.error("Failed to save logs even after cleanup:",t)}}}}async clearLogs(){try{this.logs=[],await c.storage.local.remove(this.storageKey),this.info("Logs cleared successfully")}catch(e){throw console.error("Failed to clear logs:",e),e}}async getLogCount(){return this.logs.length}async exportLogs(){try{let e={};if(typeof localStorage<"u")try{const o=localStorage.getItem("main-store");o?(e=JSON.parse(o),delete e.log,delete e.isSwiping,delete e.lastSwipeProfile,delete e.lastHeartbeat,delete e.lastActivity,delete e.subscriptionCheckAttempts,console.log("Found main-store in DOM localStorage")):console.log("main-store not found in DOM localStorage")}catch(o){console.error("Error parsing main-store from localStorage:",o)}else console.log("DOM localStorage not available in this context");console.log("Final options object:",e);const t=await this.loadLogs(),s={logs:t,options:e,exportDate:new Date().toISOString(),version:this.version,logCount:t.length,contexts:[...new Set(t.map(o=>o.context))],timeRange:t.length>0?{start:new Date(t[0].timestamp).toISOString(),end:new Date(t[t.length-1].timestamp).toISOString()}:null};return this.info("Options: Logs exported by user",{filename:`auto-swiper-logs-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,logCount:t.length}),s}catch(e){throw this.error("Failed to export logs",{error:e.message}),e}}async getLogsForDisplay(e=50){return(await this.loadLogs()).slice(-e).reverse()}async getLogsByLevel(e){return(await this.loadLogs()).filter(s=>s.level===e)}async getLogsByContext(e){return(await this.loadLogs()).filter(s=>s.context===e)}async getStorageStats(){const e=await this.loadLogs(),t=JSON.stringify(e).length;return{totalLogs:e.length,maxLogs:this.maxLogs,storageUsed:t,storageUsedKB:Math.round(t/1024*100)/100,oldestLog:e.length>0?new Date(e[0].timestamp).toISOString():null,newestLog:e.length>0?new Date(e[e.length-1].timestamp).toISOString():null}}}const r=new ue,R="https://app.auto-swiper.ch/api/v3",G=R+"/login",z=R+"/location/distance",Z=R+"/sessions/start",J=R+"/sessions/update",H=R+"/sessions/end",X=R+"/instance/registerUnauth",Q=R+"/sessions/startUnauth",ee=R+"/sessions/updateUnauth",te=R+"/sessions/endUnauth";async function W(){const a=await c.storage.local.get({withDebuggerOutput:null});a.withDebuggerOutput!==null&&a.withDebuggerOutput}W();const K=async(a,e,t)=>{if(a.loginEmail.length<4||a.loginPassword.length<4)return;const s={method:"GET",url:G,params:{uuid:a.uuid},auth:{username:a.loginEmail.toLowerCase(),password:a.loginPassword},headers:{Accept:"application/json","Content-Type":"application/json"}};try{let i=(await e.request(s)).data;a.loginToken=i.data.token,await c.storage.local.set({loginToken:i.data.token})}catch(o){r.error("Auth token request failed",{error:o.message}),t.warning(c.i18n.getMessage("ERROR_LOGIN_REQUEST"))}};function U(a){if(!a)return[];function e(o){if(!o||typeof o.querySelectorAll!="function")return[];let i=[];function n(u){const S=/((https?:)?\/\/[^\s"'()<>]+(?:\.[^\s"'()<>]+)*(?:[^\s"'()<>]*))/gi,b=u.match(S);return b||[]}return[o,...Array.from(o.querySelectorAll("*"))].forEach(u=>{for(let S=0;S<u.attributes.length;S++){const b=u.attributes[S].value;i.push(...n(b))}if(u.style&&typeof u.style.cssText=="string"&&i.push(...n(u.style.cssText)),window.getComputedStyle){const S=window.getComputedStyle(u);for(let b=0;b<S.length;b++){const M=S.getPropertyValue(S[b]);i.push(...n(M))}}u.innerHTML&&typeof u.innerHTML=="string"&&i.push(...n(u.innerHTML))}),i}let t=[];if(a instanceof Element)t=[a];else if(typeof NodeList<"u"&&a instanceof NodeList||typeof HTMLCollection<"u"&&a instanceof HTMLCollection||Array.isArray(a))t=Array.from(a);else return[];const s=t.flatMap(e);return Array.from(new Set(s))}const de=async(a,e,t,s)=>{if(!e.loginToken||e.loginToken.length<20)if(t)await K(e,t,s);else throw new Error("No valid authentication token");const o={method:"POST",headers:{Authorization:"Bearer "+e.loginToken,"Content-Type":"application/json"},body:JSON.stringify({uuid:e.uuid,site:a.site,scheduled_session_id:a.scheduled_session_id||null})};try{const i=await fetch(Z,o);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const n=await i.json();return r.info("Session started successfully",{sessionData:n}),s&&s.success("Session started successfully"),n}catch(i){throw r.error("Error starting session",{error:i.message}),s&&s.error("Failed to start session: "+i.message),i}},ge=async(a,e,t,s,o)=>{if(!t.loginToken||t.loginToken.length<20)if(s)await K(t,s,o);else throw new Error("No valid authentication token");const i={method:"PUT",headers:{Authorization:"Bearer "+t.loginToken,"Content-Type":"application/json"},body:JSON.stringify({uuid:t.uuid,session_id:a,swipes_left:e.swipes_left,swipes_right:e.swipes_right,swipes_total:e.swipes_total,logs:e.logs||[]})};try{const n=await fetch(J,i);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const l=await n.json();return r.info("Session updated successfully",{sessionData:l}),l}catch(n){throw r.error("Error updating session",{error:n.message}),n}},re=async(a,e,t,s,o)=>{if(!t.loginToken||t.loginToken.length<20)if(s)await K(t,s,o);else throw new Error("No valid authentication token");const i={uuid:t.uuid,session_id:a,swipes_left:e.swipes_left,swipes_right:e.swipes_right,swipes_total:e.swipes_total,logs:e.logs||[],ended_at:e.ended_at||new Date().toISOString(),status:e.status||"completed",failure_reason:e.failure_reason||null,error_details:e.error_details||null},n={method:"PUT",headers:{Authorization:"Bearer "+t.loginToken,"Content-Type":"application/json"},body:JSON.stringify(i)};try{const l=await fetch(H,n);if(!l.ok){let S=null;try{S=await l.json()}catch{}const b=new Error(`HTTP ${l.status}: ${l.statusText}`);throw b.status=l.status,b.responseData=S,b}const u=await l.json();return r.info("Session ended successfully",{sessionData:u}),o&&o.success("Session completed successfully"),u}catch(l){throw l.status?r.error("Error ending session",{error:l.message,status:l.status,responseData:l.responseData}):r.error("Error ending session",{error:l.message}),o&&o.error("Failed to end session: "+l.message),l}},se=async(a,e,t,s,o)=>{if(!t.loginToken||t.loginToken.length<20)throw new Error("No valid authentication token");const i={method:"PUT",headers:{Authorization:"Bearer "+t.loginToken,"Content-Type":"application/json"},body:JSON.stringify({uuid:t.uuid,session_id:a,swipes_left:0,swipes_right:0,swipes_total:0,status:"failed",failure_reason:e.reason||"Session execution failed",error_details:{error_message:e.message||"Unknown error",error_stack:e.stack,timestamp:e.timestamp||new Date().toISOString(),session_type:e.session_type||"regular"},ended_at:new Date().toISOString()})};try{const n=await fetch(H,i);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const l=await n.json();return r.info("Session failure reported",{sessionData:l,errorDetails:e}),l}catch(n){throw r.error("Error reporting session failure",{error:n.message}),n}},q=Object.freeze(Object.defineProperty({__proto__:null,endFreeUserSession:async(a,e,t)=>{const s={uuid:a,session_id:e,swipes_left:t.swipes_left,swipes_right:t.swipes_right,swipes_total:t.swipes_total,logs:t.logs||[],ended_at:t.ended_at||new Date().toISOString(),status:t.status||"completed",failure_reason:t.failure_reason||null,error_details:t.error_details||null},o={method:"PUT",headers:{"Content-Type":"application/json","X-Extension-UUID":a},body:JSON.stringify(s)};try{const i=await fetch(te,o);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const n=await i.json();return r.info("Free user session ended",{sessionData:n}),n}catch(i){throw r.error("Error ending free user session",{error:i.message}),i}},endSession:re,endSessionUnauthUrl:te,endSessionUrl:H,failSession:se,getAuthToken:K,getPicturesFromElement:U,loadWithDebuggerOutput:W,locationDistanceUrl:z,loginUrl:G,registerFreeUserInstance:async a=>{const e={method:"GET",headers:{"Content-Type":"application/json","X-Extension-UUID":a,"X-Extension-Version":c.runtime.getManifest().version}};try{const t=await fetch(X,e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();return r.info("Free user instance registered",{instanceData:s}),s}catch(t){throw r.error("Error registering free user instance",{error:t.message}),t}},registerUnauthUrl:X,startFreeUserSession:async(a,e)=>{const t={method:"POST",headers:{"Content-Type":"application/json","X-Extension-UUID":a},body:JSON.stringify({uuid:a,site:e.site,scheduled_session_id:e.scheduled_session_id||null})};try{const s=await fetch(Q,t);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const o=await s.json();return r.info("Free user session started",{sessionData:o}),o}catch(s){throw r.error("Error starting free user session",{error:s.message}),s}},startSession:de,startSessionUnauthUrl:Q,startSessionUrl:Z,updateFreeUserSession:async(a,e,t)=>{const s={method:"PUT",headers:{"Content-Type":"application/json","X-Extension-UUID":a},body:JSON.stringify({uuid:a,session_id:e,swipes_left:t.swipes_left,swipes_right:t.swipes_right,swipes_total:t.swipes_total,logs:t.logs||[]})};try{const o=await fetch(ee,s);if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const i=await o.json();return r.info("Free user session updated",{sessionData:i}),i}catch(o){throw r.error("Error updating free user session",{error:o.message}),o}},updateSession:ge,updateSessionUnauthUrl:ee,updateSessionUrl:J},Symbol.toStringTag,{value:"Module"}));class m{static STORAGE_KEY="autoswiper_session_backup";static MAX_RETRIES=3;static RETRY_DELAY=5e3;static saveSession(e){try{if(r.debug("SessionManager: Starting saveSession",{hasSessionData:!!e,sessionDataType:typeof e,storageKey:this.STORAGE_KEY,isStorageAvailable:this.isStorageAvailable()}),!e||typeof e!="object")return r.error("SessionManager: Invalid session data provided",{sessionData:e}),!1;if(!this.isStorageAvailable())return r.error("SessionManager: localStorage is not available"),!1;const t={...e,lastUpdateAt:new Date().toISOString()};r.debug("SessionManager: Backup data prepared",{sessionId:t.sessionId,site:t.site,status:t.status,swipeCount:t.swipeCounts?.total||0,dataSize:JSON.stringify(t).length,hasSwipeLog:!!t.swipeLog,swipeLogLength:t.swipeLog?.length||0});try{const s=JSON.stringify(t);r.debug("SessionManager: Attempting localStorage.setItem",{storageKey:this.STORAGE_KEY,dataSize:s.length,serializedDataPreview:s.substring(0,200)+"..."}),localStorage.setItem(this.STORAGE_KEY,s);const o=localStorage.getItem(this.STORAGE_KEY);if(!o)return r.error("SessionManager: Data not found after save attempt"),!1;const i=JSON.parse(o);return r.debug("SessionManager: Data verified after save",{retrievedDataSize:o.length,sessionIdMatches:i.sessionId===t.sessionId,swipeCountMatches:i.swipeCounts?.total===t.swipeCounts?.total,lastUpdateAt:i.lastUpdateAt}),r.info("SessionManager: Session backup saved and verified successfully",{sessionId:t.sessionId,site:t.site,swipeCount:t.swipeCounts?.total||0,status:t.status,storageKey:this.STORAGE_KEY}),!0}catch(s){return r.error("SessionManager: localStorage operation failed",{error:s.message,errorName:s.name,storageKey:this.STORAGE_KEY}),!1}}catch(t){return r.error("SessionManager: Failed to save session backup",{error:t.message,errorName:t.name,stack:t.stack}),!1}}static getSession(){try{r.debug("SessionManager: Attempting to retrieve session backup",{storageKey:this.STORAGE_KEY,isStorageAvailable:this.isStorageAvailable()});const e=localStorage.getItem(this.STORAGE_KEY);if(r.debug("SessionManager: Raw data retrieved from localStorage",{hasData:!!e,dataType:typeof e,dataLength:e?.length||0,dataPreview:e?e.substring(0,100)+"...":"null"}),!e)return r.debug("SessionManager: No session backup found in localStorage"),null;const t=JSON.parse(e);return r.debug("SessionManager: Retrieved session backup",{sessionId:t.sessionId,site:t.site,status:t.status,swipeCount:t.swipeCounts?.total||0,lastUpdateAt:t.lastUpdateAt,hasSwipeLog:!!t.swipeLog,swipeLogLength:t.swipeLog?.length||0}),t}catch(e){return r.error("SessionManager: Failed to get session backup",{error:e.message,errorName:e.name,stack:e.stack}),null}}static clearSession(){try{const e=this.getSession();r.debug("SessionManager: Attempting to clear session backup",{sessionId:e?.sessionId,site:e?.site,storageKey:this.STORAGE_KEY}),localStorage.removeItem(this.STORAGE_KEY);const t=localStorage.getItem(this.STORAGE_KEY);return t!==null?(r.error("SessionManager: Session backup still exists after removal attempt",{storageKey:this.STORAGE_KEY,remainingData:t}),!1):(r.debug("SessionManager: Session backup cleared and verified successfully",{sessionId:e?.sessionId,site:e?.site,storageKey:this.STORAGE_KEY}),!0)}catch(e){return r.error("SessionManager: Failed to clear session backup",{error:e.message,errorName:e.name,stack:e.stack}),!1}}static hasSession(){try{r.debug("SessionManager: Checking if session backup exists",{storageKey:this.STORAGE_KEY,isStorageAvailable:this.isStorageAvailable()});const e=localStorage.getItem(this.STORAGE_KEY),t=e!=null;return r.debug("SessionManager: Session backup existence check result",{hasSession:t,dataType:typeof e,dataLength:e?.length||0}),t}catch(e){return r.error("SessionManager: Failed to check session backup existence",{error:e.message,errorName:e.name,stack:e.stack}),!1}}static updateSessionStatus(e){try{const t=this.getSession();return t?(t.status=e,t.lastUpdateAt=new Date().toISOString(),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),r.debug("SessionManager: Session status updated",{sessionId:t.sessionId,newStatus:e}),!0):(r.warn("SessionManager: No session backup to update status"),!1)}catch(t){return r.error("SessionManager: Failed to update session status",{error:t.message}),!1}}static getBackupAge(){try{const e=this.getSession();if(!e||!e.lastUpdateAt)return null;const t=new Date(e.lastUpdateAt);return new Date().getTime()-t.getTime()}catch(e){return r.error("SessionManager: Failed to calculate backup age",{error:e.message}),null}}static isStorageAvailable(){try{const e="autoswiper_storage_test",t="test";r.debug("SessionManager: Testing localStorage availability",{testKey:e,testValue:t,localStorageExists:typeof localStorage<"u"}),localStorage.setItem(e,t);const s=localStorage.getItem(e);localStorage.removeItem(e);const o=s===t;return r.debug("SessionManager: localStorage availability test result",{isAvailable:o,retrieved:s,expected:t,matches:s===t}),o}catch(e){return r.error("SessionManager: localStorage not available",{error:e.message,errorName:e.name,localStorageType:typeof localStorage,stack:e.stack}),!1}}static getStorageInfo(){try{const e=this.getSession();return e?{hasBackup:!0,backupSize:JSON.stringify(e).length,sessionId:e.sessionId,site:e.site,status:e.status,lastUpdate:e.lastUpdateAt,isStorageAvailable:this.isStorageAvailable()}:{hasBackup:!1,backupSize:0,isStorageAvailable:this.isStorageAvailable()}}catch(e){return r.error("SessionManager: Failed to get storage info",{error:e.message}),{hasBackup:!1,backupSize:0,isStorageAvailable:!1,error:e.message}}}static async checkAndSendBackup(e){try{const t=this.getSession();if(!t)return r.debug("SessionManager: No backup found, proceeding with new session"),!0;if(!t.sessionId||t.sessionId===null)return r.warn("SessionManager: Clearing invalid backup with null sessionId",{site:t.site,swipeCount:t.swipeCounts?.total||0,lastUpdateAt:t.lastUpdateAt,startedAt:t.startedAt,status:t.status}),this.clearSession(),!0;r.info("SessionManager: Found backup session, attempting to send",{sessionId:t.sessionId,site:t.site,status:t.status,swipeCount:t.swipeCounts?.total||0,attempts:t.attempts||0,lastUpdateAt:t.lastUpdateAt,createdAt:t.startedAt}),this.updateSessionStatus("sending");try{if(await this.sendSessionWithRetry(t,e))return this.clearSession(),r.info("SessionManager: Backup session sent and cleared successfully"),!0}catch(s){if(r.error("SessionManager: Backup send failed",{sessionId:t.sessionId,error:s.message,errorStatus:s.status,errorData:s.responseData,backupAge:t.lastUpdateAt?new Date-new Date(t.lastUpdateAt):"unknown"}),this.isSessionNotFoundError(s))return r.warn("SessionManager: Clearing stale/invalid backup and allowing new session",{sessionId:t.sessionId,errorType:s.status===404?"NOT_FOUND":s.status===400?"BAD_REQUEST":s.status===422?"VALIDATION_ERROR":"OTHER",error:s.message,responseData:s.responseData}),this.clearSession(),!0;r.warn("SessionManager: Non-recoverable backup error, considering clearing backup",{sessionId:t.sessionId,error:s.message,errorStatus:s.status});const o=t.lastUpdateAt?new Date-new Date(t.lastUpdateAt):1/0,i=1440*60*1e3;if(o>i)return r.warn("SessionManager: Clearing old backup to prevent permanent blocking",{sessionId:t.sessionId,backupAgeHours:Math.round(o/(3600*1e3)),error:s.message}),this.clearSession(),!0;throw this.updateSessionStatus("pending"),new Error(`Cannot start new session: failed to send previous session backup (${s.message})`)}}catch(t){throw r.error("SessionManager: Error in checkAndSendBackup",{error:t.message}),t}}static async sendSessionWithRetry(e,t,s=1){try{return r.debug(`SessionManager: Sending session attempt ${s}/${this.MAX_RETRIES}`,{sessionId:e.sessionId,site:e.site}),await this.sendSession(e,t),r.info("SessionManager: Session sent successfully on attempt",{attempt:s}),!0}catch(o){if(r.warn(`SessionManager: Send attempt ${s} failed`,{error:o.message}),this.isSessionNotFoundError(o))return r.warn("Session not found on server, clearing backup and continuing",{sessionId:e.sessionId,error:o.message}),this.clearSession(),!0;if(s<this.MAX_RETRIES)return r.debug(`SessionManager: Retrying in ${this.RETRY_DELAY}ms`),await new Promise(i=>setTimeout(i,this.RETRY_DELAY)),this.sendSessionWithRetry(e,t,s+1);throw r.error(`SessionManager: All ${this.MAX_RETRIES} attempts failed`),o}}static async updateSession(e,t){try{const s={swipes_left:e.swipeCounts.left,swipes_right:e.swipeCounts.right,swipes_total:e.swipeCounts.total,logs:e.swipeLog||[]};if(e.sessionId){if(r.debug("SessionManager: Using unified session update API"),t.loginToken&&!t.isFree)try{const{updateSession:o}=await Promise.resolve().then(()=>q),i={loginToken:t.loginToken,uuid:t.uuid};await o(e.sessionId,s,i,null,null),r.info("SessionManager: Authenticated session updated successfully");return}catch(o){const i=new Error(o.message);throw i.status=o.status||(o.message.includes("HTTP 404")?404:null),i.responseData=o.responseData,i}else if(e.uuid){await this.updateFreeUserSession(e.uuid,e.sessionId,s),r.info("SessionManager: Free user session updated successfully");return}}throw new Error("No valid session update method available")}catch(s){throw r.error("SessionManager: Failed to update session",{error:s.message}),s}}static async updateFreeUserSession(e,t,s){try{const{updateFreeUserSession:o}=await Promise.resolve().then(()=>q),i=await o(e,t,s);return i&&i.status?(r.info("SessionManager: Free user session updated successfully"),!0):(r.error("SessionManager: Failed to update free user session",{response:i}),!1)}catch(o){throw r.error("SessionManager: Error updating free user session",{error:o.message}),o}}static async sendSession(e,t){try{const s={swipes_left:e.swipeCounts.left,swipes_right:e.swipeCounts.right,swipes_total:e.swipeCounts.total,logs:e.swipeLog||[],ended_at:e.endedAt};if(!e.sessionId)throw new Error("No session ID - session must be started with startSession() first");if(t.loginToken&&!t.isFree){await re(e.sessionId,s,t,null,null),r.info("SessionManager: Authenticated session ended successfully");return}else if(e.uuid){await this.endFreeUserSession(e.uuid,e.sessionId,s),r.info("SessionManager: Free user session ended successfully");return}throw new Error("No valid authentication method available")}catch(s){throw r.error("SessionManager: Failed to send session",{error:s.message}),s}}static async endFreeUserSession(e,t,s){try{const{endSessionUnauthUrl:o}=await Promise.resolve().then(()=>q),i={method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({uuid:e,session_id:t,...s})},n=await fetch(o,i);if(!n.ok){const u=await n.text();let S;try{S=JSON.parse(u)}catch{S={message:u}}const b=new Error(`HTTP ${n.status}: ${n.statusText}`);throw b.responseData=S,b.status=n.status,b}const l=await n.json();return r.info("SessionManager: Free user session ended",{data:l}),l}catch(o){throw r.error("SessionManager: Error ending free user session",{error:o.message}),o}}static async reportFailedSession(e,t,s="Session backup recovery failed"){try{if(!e.sessionId){r.warn("SessionManager: Cannot report failed session without sessionId");return}const o={reason:s,message:"Session failed during backup recovery",timestamp:new Date().toISOString(),session_type:"backup_recovery",original_session:{site:e.site,swipe_count:e.swipeCounts?.total||0,started_at:e.startedAt,ended_at:e.endedAt}};await se(e.sessionId,o,t,null,null),r.info("SessionManager: Failed session reported successfully")}catch(o){r.error("SessionManager: Failed to report failed session",{error:o.message})}}static isSessionNotFoundError(e){if(e.status===404)return!0;if(e.status===400)return r.warn("SessionManager: HTTP 400 error treated as stale backup",{error:e.message,responseData:e.responseData}),!0;if(e.status===422)return r.warn("SessionManager: HTTP 422 error treated as stale backup",{error:e.message,responseData:e.responseData}),!0;if(e.responseData){const{error_code:t,message:s}=e.responseData;return t==="SESSION_NOT_FOUND"||t==="VALIDATION_ERROR"||s&&s.toLowerCase().includes("session not found")}if(e.message){const t=e.message.toLowerCase();return t.includes("session not found")||t.includes("http 404")||t.includes("http 400")||t.includes("http 422")||t.includes("validation failed")}return!1}static clearOldBackupIfStuck(){try{const e=this.getSession();if(!e)return!1;const t=e.lastUpdateAt?new Date-new Date(e.lastUpdateAt):1/0,s=3600*1e3;return t>s?(r.warn("SessionManager: Emergency clearing of stuck backup",{sessionId:e.sessionId,backupAgeHours:Math.round(t/(3600*1e3)),reason:"backup_too_old"}),this.clearSession(),!0):!1}catch(e){return r.error("SessionManager: Error in emergency backup clearing",{error:e.message}),!1}}static getRetryStats(){return{maxRetries:this.MAX_RETRIES,retryDelay:this.RETRY_DELAY}}static debounce(e,t){let s;return function(...i){const n=()=>{clearTimeout(s),e(...i)};clearTimeout(s),s=setTimeout(n,t)}}static throttle(e,t){let s;return function(...i){s||(e.apply(this,i),s=!0,setTimeout(()=>s=!1,t))}}static formatDateTime(e){const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return`${t}-${s}-${o} ${i}:${n}:${l}`}static createSessionData(e,t="active"){return{sessionId:e.options.sessionId||null,uuid:e.options.uuid,site:e.site?.getSiteName()||"unknown",startedAt:e.sessionStartedAt?this.formatDateTime(new Date(e.sessionStartedAt)):this.formatDateTime(new Date),endedAt:this.formatDateTime(new Date),swipeCounts:{total:e.swipeCounts.total,left:e.swipeCounts.left,right:e.swipeCounts.right},swipeLog:[...e.options.swipeLog||[]],options:e.options,attempts:0,status:t}}static isRecoverableError(e){if(!e)return!1;const t=e.message?.toLowerCase()||"";return["fetch","network","timeout","connection","http 5","failed to fetch","network error","internet","offline"].some(o=>t.includes(o))}static generateId(){return Math.random().toString(36).substr(2,9)}static safeJsonParse(e,t=null){try{return JSON.parse(e)}catch(s){return r.error("SessionManager: JSON parse failed",{error:s.message}),t}}static safeJsonStringify(e,t="{}"){try{return JSON.stringify(e)}catch(s){return r.error("SessionManager: JSON stringify failed",{error:s.message}),t}}static saveSessionDebounced=this.debounce((e,t="active")=>{const s=this.createSessionData(e,t);return this.saveSession(s)},2e3);static async initialize(e){try{return r.info("SessionManager: Initializing session manager"),this.isStorageAvailable()?await this.checkAndSendBackup(e):(r.warn("SessionManager: localStorage not available, session backup disabled"),!0)}catch(t){throw r.error("SessionManager: Failed to initialize",{error:t.message}),t}}static async completeSession(e,t){try{const s=this.createSessionData(e,"pending");return await this.sendSession(s,t),this.clearSession(),r.info("SessionManager: Session completed and sent successfully"),!0}catch(s){r.warn("SessionManager: Failed to send session immediately, saving as backup",{error:s.message});const o=this.createSessionData(e,"pending");return this.saveSession(o)}}}m.debug={inspectStorage(){console.group("SessionManager Debug: Storage Inspection");try{const a=m.isStorageAvailable();if(console.log("üìä localStorage Available:",a),!a){console.error("‚ùå localStorage is not available"),console.groupEnd();return}console.log("üîë Storage Key:",m.STORAGE_KEY);const e=localStorage.getItem(m.STORAGE_KEY);if(console.log("üìÑ Raw Data:",e),console.log("üìè Raw Data Length:",e?.length||0),e)try{const t=JSON.parse(e);console.log("üìã Parsed Data:",t),console.log("üÜî Session ID:",t.sessionId),console.log("üåê Site:",t.site),console.log("üìä Swipe Count:",t.swipeCounts?.total||0),console.log("‚è∞ Last Update:",t.lastUpdateAt),console.log("üîÑ Status:",t.status)}catch(t){console.error("‚ùå Failed to parse stored data:",t)}else console.log("‚ÑπÔ∏è No session backup found");console.log("üóÇÔ∏è All localStorage keys:");for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t),o=localStorage.getItem(s);console.log(`  ${s}: ${o?.substring(0,50)}${o?.length>50?"...":""}`)}}catch(a){console.error("‚ùå Storage inspection failed:",a)}console.groupEnd()},testStorage(){console.group("SessionManager Debug: Storage Test");try{const a="autoswiper_debug_test",e={timestamp:new Date().toISOString(),test:"debug-test-data",random:Math.random()};console.log("üß™ Testing localStorage with test data:",e),localStorage.setItem(a,JSON.stringify(e)),console.log("‚úÖ Test data saved");const t=localStorage.getItem(a);if(console.log("üìÑ Retrieved raw data:",t),t){const s=JSON.parse(t);console.log("üìã Parsed data:",s),console.log("‚úÖ Data matches:",JSON.stringify(e)===JSON.stringify(s))}localStorage.removeItem(a),console.log("üßπ Test data cleaned up"),console.log("‚úÖ localStorage test completed successfully")}catch(a){console.error("‚ùå Storage test failed:",a)}console.groupEnd()},createMockSession(){console.group("SessionManager Debug: Create Mock Session");try{const a={sessionId:"debug-session-"+Math.random().toString(36).substr(2,9),uuid:"debug-uuid-123",site:"tinder",startedAt:m.formatDateTime(new Date),endedAt:m.formatDateTime(new Date),swipeCounts:{total:5,left:3,right:2},swipeLog:[{name:"Test User 1",age:25,reason:"Test left swipe"},{name:"Test User 2",age:28,reason:"Test right swipe"}],options:{isFree:!0},attempts:0,status:"active",lastUpdateAt:new Date().toISOString()};console.log("üé≠ Mock session data:",a);const e=m.saveSession(a);if(console.log("üíæ Save result:",e),e){const t=m.getSession();console.log("üìã Retrieved session:",t),console.log("‚úÖ Mock session created and verified")}else console.error("‚ùå Failed to save mock session")}catch(a){console.error("‚ùå Mock session creation failed:",a)}console.groupEnd()},clearAll(){console.group("SessionManager Debug: Clear All Data");try{const a=m.hasSession();console.log("üîç Had session before clear:",a);const e=m.clearSession();console.log("üßπ Clear result:",e);const t=m.hasSession();console.log("üîç Has session after clear:",t),console.log("‚úÖ Clear operation completed")}catch(a){console.error("‚ùå Clear operation failed:",a)}console.groupEnd()},help(){console.group("SessionManager Debug: Help"),console.log("Available debug methods:"),console.log("SessionManager.debug.inspectStorage() - Inspect current localStorage state"),console.log("SessionManager.debug.testStorage() - Test localStorage functionality"),console.log("SessionManager.debug.createMockSession() - Create a mock session for testing"),console.log("SessionManager.debug.clearAll() - Clear all session data"),console.log("SessionManager.debug.help() - Show this help message"),console.groupEnd()}},typeof window<"u"&&(window.SessionManagerDebug=m.debug,r.info("SessionManager: Debug utilities available as window.SessionManagerDebug"));const{saveSession:Pe,getSession:Me,clearSession:Ie,hasSession:_e,updateSessionStatus:Le,updateSession:De,updateFreeUserSession:Re,checkAndSendBackup:qe,clearOldBackupIfStuck:Ue,debounce:Ne,throttle:Oe,formatDateTime:Fe,createSessionData:Be,isRecoverableError:je,generateId:Ke,safeJsonParse:He,safeJsonStringify:We}=m;class pe{autoSwiper=null;profileCard=null;recentlyActive=!1;getSiteName(){return"tinder"}getSwipeSpeedModifier(){return window.location.href.includes("app/likes-you")||window.location.href.includes("app/gold-home")?1:.65}getElementForKeyEvents(){return window.body??document.body??document.documentElement}swipeLeft(){try{const e=document.querySelector(".profileCard__card");if(!e)return r.warn("Tinder swipeLeft: .profileCard__card not found"),!1;const t=e.parentElement;if(!t)return r.warn("Tinder swipeLeft: parentElement 1 not found"),!1;const s=t.parentElement;if(!s||!s.children[1])return r.warn("Tinder swipeLeft: parentElement 2 or children[1] not found"),!1;const o=s.children[1].querySelectorAll("button");if(!o||o.length===0)return r.warn("Tinder swipeLeft: No buttons found"),!1;const i=o[0];return i?(i.click(),!0):(r.warn("Tinder swipeLeft: Button not found"),!1)}catch(e){return r.error("Tinder swipeLeft error",{error:e.message}),!1}}swipeRight(){try{const e=document.querySelector(".profileCard__card");if(!e)return r.warn("Tinder swipeRight: .profileCard__card not found"),!1;const t=e.parentElement;if(!t)return r.warn("Tinder swipeRight: parentElement 1 not found"),!1;const s=t.parentElement;if(!s||!s.children[1])return r.warn("Tinder swipeRight: parentElement 2 or children[1] not found"),!1;const o=s.children[1].querySelectorAll("button");if(!o||o.length<3)return r.warn("Tinder swipeRight: Not enough buttons found",{buttonCount:o?.length||0}),!1;const i=o[2];return i?(i.click(),!0):(r.warn("Tinder swipeRight: Button not found"),!1)}catch(e){return r.error("Tinder swipeRight error",{error:e.message}),!1}}removeMessages(){try{const e=document.querySelector('[role="dialog"]');if(e){const t=e.querySelectorAll("button");if(e.children[2]?.children?.length===2)if(e.textContent?.search("Rewinds")>0){e.children[2]?.children[1]?.click?.(),r.info("Tinder: Closed Rewinds Dialog");return}else if(e.textContent?.search("Super")>0){e.children[2]?.children[1]?.click?.(),r.info("Tinder: Closed Super Likes Dialog");return}else if(e.textContent?.search("prioritise")>0){e.children[2]?.children[1]?.click?.(),r.info("Tinder: Closed upgrade likes Dialog (Platinum Upgrade)");return}else{this.autoSwiper&&(this.autoSwiper.stop=!0),r.warn("Tinder: Out of likes, stopping auto swiper");return}else if(e.children[3]?.children?.length===1){r.info("Tinder: Upgrade Likes Dialog, closing it"),e.children[3]?.click?.();return}else if(t.length===2){r.info("Tinder: Upgrade SuperLikes Dialog, closing it"),t[1]?.click?.();return}else e.children[5]&&(r.info("Tinder: Closing Dialog"),e.children[5]?.click?.())}}catch(e){r.error("Tinder removeMessages error",{error:e.message})}try{let e=document.querySelector('[data-testid="recCard_info"]');e&&(r.info("Tinder: Closing info Dialog"),e.click()),e=document.querySelector(".close"),e&&!window.location.href.includes("app/likes-you")&&(e.click(),r.info("Tinder: Closed match Dialog"))}catch(e){r.error("Tinder removeMessages (secondary) error",{error:e.message})}}getProfileCard(){let e=null;try{let t=!0;if((window.location.href.includes("app/recs")||window.location.href.includes("app/explore")||window.location.href.includes("app/likes-you")||window.location.href.includes("app/gold-home"))&&(t=!1),t){const s=document.querySelector("[href='/app/profile']");s&&s.hidden===!1&&s.click(),setTimeout(function(){const o=document.querySelector("[href='/app/recs']");o&&!o.className.toString().includes("Op(1)")&&o.hidden===!1&&o.click()},250)}if(this.autoSwiper?.mobile){if(window.location.href.includes("app/likes-you")||window.location.href.includes("app/gold-home")){const s=document.querySelectorAll('[data-testid="likesYouCard"]');s&&s.length>0&&s[0].children[2]&&s[0].children[2].click()}else if(e=document.querySelector(".profileContent"),!e){const s=document.querySelector(".recsCardboard__cardsContainer");if(s){const o=s.querySelector("button.focus-button-style");o&&o.click()}}}else if(window.location.href.includes("app/likes-you")){const s=document.querySelectorAll('[data-testid="likesYouCard"]');s&&s.length>0&&s[0].children[2]&&s[0].children[2].click()}else{const s=document.querySelector(".recsCardboard__cardsContainer");if(s){const o=s.querySelectorAll(".Pos\\(a\\).D\\(f\\).Jc\\(sb\\).C\\(\\$c-ds-text-primary-overlay\\).Ta\\(start\\).W\\(100\\%\\).Ai\\(fe\\).B\\(0\\).P\\(8px\\)--xs.P\\(16px\\).P\\(20px\\)--l.Cur\\(p\\).focus-button-style");if(o&&o.length>1){const n=o[1].querySelector(".Sq\\(8px\\).Bdrs\\(50\\%\\).Mend\\(4px\\).My\\(4px\\).Bgc\\(\\$c-ds-background-badge-online-now-default\\)");this.recentlyActive=!!n}else this.recentlyActive=!1;const i=s.querySelector("button.focus-button-style");i&&i.click()}}}catch(t){r.error("Tinder getProfileCard error",{error:t.message})}return document.querySelector(".profileContent")}getName(){try{if(!this.profileCard)return r.warn("Tinder getName: profileCard not set"),"";const e=this.profileCard.querySelector(".Fxs\\(1\\)");return e&&e.children[0]?e.children[0].innerText.trim():""}catch(e){return r.error("Tinder getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("Tinder getAge: profileCard not set"),"";const e=this.profileCard.querySelector(".Whs\\(nw\\)");return e?e.innerText.trim():""}catch(e){return r.error("Tinder getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Tinder getHeight error",{error:e.message})}return null}getDistance(){let e=5e5;try{const t=document.querySelector('svg path[d="M12.301 23.755c.746-.659 9.449-8.339 9.449-14.337C21.75 4.138 17.463 0 11.998 0 6.534 0 2.25 4.138 2.25 9.418c0 2.675 1.602 5.91 4.769 9.616a45.204 45.204 0 0 0 4.737 4.759l.246.207.26-.21zm-.305-2.424c.94-.889 2.376-2.32 3.77-4.011 1.084-1.315 2.105-2.741 2.847-4.152.753-1.433 1.142-2.705 1.142-3.75 0-4.113-3.328-7.423-7.757-7.423-4.428 0-7.753 3.309-7.753 7.423 0 1.941 1.208 4.713 4.29 8.319a42.901 42.901 0 0 0 3.461 3.594"]');if(t){let s=t.parentElement?.parentElement?.parentElement;if(s&&s.innerText===""&&(s=t.parentElement?.parentElement?.parentElement?.parentElement),s){const o=s.innerText.match(/\d+/);if(o)return e=parseInt(o[0]),e}}}catch(t){r.error("Tinder getDistance error",{error:t.message})}return e}getLocation(){let e="";try{if(!this.profileCard)return r.warn("Tinder getLocation: profileCard not set"),e;const t=this.profileCard.children[1]?.children[0]?.children[0]?.children[1]?.children;if(t)for(const s of t){const i=s.innerText.match(/Lives in (.*)/);i&&(e=i[1],r.debug("Tinder getLocation",{location:e}))}}catch(t){return r.error("Tinder getLocation error",{error:t.message}),e}return e}getProfileDescriptionText(){try{if(!this.profileCard)return r.warn("Tinder getProfileDescriptionText: profileCard not set"),"";let e=this.profileCard.querySelector(".BreakWord");return e?e.innerText:(e=this.profileCard.querySelector('svg path[d="M7.713 3.826c-.699-.568-1.7-.607-2.388-.027C2.022 6.584 0 10.285 0 14.493c0 4.181 2.75 6.644 5.842 6.644 2.864 0 5.27-2.406 5.27-5.327 0-2.807-2.005-4.697-4.41-4.697-.595 0-1.088-.531-.8-1.051.455-.82 1.109-1.642 1.829-2.36C8.76 6.678 8.918 4.806 7.79 3.89zm12.888 0c-.699-.568-1.7-.607-2.388-.027-3.303 2.785-5.325 6.486-5.325 10.694 0 4.181 2.807 6.644 5.9 6.644 2.806 0 5.212-2.406 5.212-5.327 0-2.807-1.948-4.697-4.41-4.697-.586 0-1.07-.534-.782-1.044.46-.818 1.108-1.639 1.819-2.356 1.023-1.032 1.178-2.908.05-3.824z"]'),e?e.parentElement?.parentElement?.parentElement?.parentElement?.children[1]?.innerText??"":"")}catch(e){return r.error("Tinder getProfileDescriptionText error",{error:e.message}),""}}async getProfilePictureUrls(){r.debug("Tinder: Getting profile picture URLs...");const e=50,t=2e3,s=document.querySelector(".profileContent");if(!s)return r.warn("Tinder: Element .profileContent not found."),[];const o=s.querySelector(".Expand > .CenterAlign");if(!o)return r.warn("Tinder: Scroller (.Expand > .CenterAlign) not found within .profileContent."),[];const i=Array.from(o.children);let n=[],l=null;function u(g){const v=g.match(/url\(["']?(.*?)["']?\)/);return v?v[1]:null}function S(){const g=s.querySelector('.keen-slider__slide[aria-hidden="false"]');if(!g)return{slideIndex:null,imageUrl:null};const v=Array.from(g.parentNode.children).indexOf(g),E=g.querySelector(".profileCard__slider__imgShadow .profileCard__slider__img"),T=E&&E.style.backgroundImage?u(E.style.backgroundImage):null;return{slideIndex:v,imageUrl:T}}async function b(g,v){const E=Date.now();for(;Date.now()-E<t;){const{slideIndex:T,imageUrl:N}=S();if(T!==null&&N!==null&&(T!==g||N!==v))return{slideIndex:T,imageUrl:N};await new Promise(L=>setTimeout(L,e))}return{slideIndex:null,imageUrl:null}}const M=S();M.slideIndex,l=M.imageUrl,l&&!n.includes(l)?(n.push(l),r.debug("Tinder: Collected initial image",{imageUrl:l})):r.debug("Tinder: No initial image found.");for(let g=0;g<i.length;g++){const v=i[g],{slideIndex:E,imageUrl:T}=S();if(E===g){r.debug(`Tinder: Slide ${g} already active, extracting image...`),T&&!n.includes(T)&&(n.push(T),r.debug("Tinder: Collected image from already active slide",{imageUrl:T}));continue}r.debug(`Tinder: Clicking scroller child ${g}...`),v.click();const{slideIndex:N,imageUrl:L}=await b(E,T);if(N!==null&&L&&!n.includes(L))n.push(L),r.debug("Tinder: Collected image after click",{imageUrl:L});else{const O=S();O.imageUrl&&!n.includes(O.imageUrl)?(n.push(O.imageUrl),r.debug("Tinder: Fallback - Collected image after failed wait",{imageUrl:O.imageUrl})):r.debug("Tinder: Could not collect image for slide",{slideIndex:g})}l=L!==null?L:T}return r.debug("Tinder: Final collected URLs",{urls:n,count:n.length}),n}getProfileText(){try{return this.profileCard?this.profileCard.innerText:(r.warn("Tinder getProfileText: profileCard not set"),"")}catch(e){return r.error("Tinder getProfileText error",{error:e.message}),""}}getPhotoCount(){try{if(!this.profileCard)return r.warn("Tinder getPhotoCount: profileCard not set"),1;const e=this.profileCard.querySelector(".Expand>.CenterAlign");return e?e.childNodes.length:1}catch(e){return r.error("Tinder getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){try{const e=document.querySelector(".D\\(ib\\).Lh\\(0\\).Sq\\(18px\\).Mstart\\(4px\\).As\\(c\\)");if(e&&e.querySelector("svg.Expand"))return!0}catch(e){r.error("Tinder getVerifiedStatus error",{error:e.message})}return!1}getRecentlyActive(){return this.recentlyActive}supportRandomUsageSimulation=!0;activePictureIndex=0;doRandomUsageSimulation(){try{this.activePictureIndex++,this.activePictureIndex>this.getPhotoCount()&&(this.activePictureIndex=0);const e=Math.floor(Math.random()*700+300),t=Math.floor(Math.random()*700+300);if(this.activePictureIndex===1)this.profileCard?.scroll&&this.profileCard.scroll({top:e,left:0,behavior:"smooth"}),setTimeout(()=>{this.profileCard?.scroll&&this.profileCard.scroll({top:0,left:0,behavior:"smooth"}),this.getPhotoCount()>1&&setTimeout(()=>{const s=this.profileCard?.querySelector(".Expand>.CenterAlign");s&&s.children[this.activePictureIndex]&&s.children[this.activePictureIndex].click()},t)},t);else if(this.getPhotoCount()>1){const s=this.profileCard?.querySelector(".Expand>.CenterAlign");s&&s.children[this.activePictureIndex]&&s.children[this.activePictureIndex].click()}}catch(e){r.error("Tinder doRandomUsageSimulation error",{error:e.message})}}reset(){this.activePictureIndex=0}openChatPage(){try{const e=document.querySelectorAll("[role=tab]");e.length>1&&e[1]?e[1].click():r.warn("Tinder openChatPage: Not enough tabs found")}catch(e){r.error("Tinder openChatPage error",{error:e.message})}}getChatList(){try{return document.querySelectorAll(".messageListItem")}catch(e){return r.error("Tinder getChatList error",{error:e.message}),[]}}openChat(e){try{e&&typeof e.click=="function"?e.click():r.warn("Tinder openChat: chatElement invalid or missing click()")}catch(t){r.error("Tinder openChat error",{error:t.message})}}getMessages(e){try{return e?.querySelectorAll(".msgHelper")??[]}catch(t){return r.error("Tinder getMessages error",{error:t.message}),[]}}sendMessage(e){try{const t=document.querySelector("textarea"),s=document.querySelector('button[type="submit"]');t&&s?(t.value=e,s.click()):r.warn("Tinder sendMessage: textarea or submit button not found")}catch(t){r.error("Tinder sendMessage error",{error:t.message})}}}class he{autoSwiper=null;profileCard=null;getSiteName(){return"bumble"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return window??document??document.body}swipeLeft(){try{if(window.location.href.includes("app/beeline")){const e=document.querySelector(".user-card__action--no");e?e.click():r.warn("Bumble swipeLeft: .user-card__action--no button not found")}else this.autoSwiper?.simulateDebuugerKeyEvent&&this.autoSwiper?.keys?.arrowLeft?this.autoSwiper.simulateDebuugerKeyEvent(this.autoSwiper.keys.arrowLeft):r.warn("Bumble swipeLeft: autoSwiper or keys.arrowLeft not available")}catch(e){r.error("Bumble swipeLeft error",{error:e.message})}}swipeRight(){try{if(window.location.href.includes("app/beeline")){const e=document.querySelector(".user-card__action--yes");if(e){e.click();const t=document.querySelector(".profile__close");t?t.click():r.warn("Bumble swipeRight: .profile__close button not found")}else r.warn("Bumble swipeRight: .user-card__action--yes button not found")}else this.autoSwiper?.simulateDebuugerKeyEvent&&this.autoSwiper?.keys?.arrowRight?this.autoSwiper.simulateDebuugerKeyEvent(this.autoSwiper.keys.arrowRight):r.warn("Bumble swipeRight: autoSwiper or keys.arrowRight not available")}catch(e){r.error("Bumble swipeRight error",{error:e.message})}}removeMessages(){try{if(document.querySelector(".encounters-user__blocker")){this.autoSwiper&&(this.autoSwiper.stop=!0),r.warn("Bumble: Out of likes, stopping auto swiper");return}const t=document.querySelector('button.button.button--narrow.button--size-m.color-white.button--transparent[data-qa-role="button"]');if(t){this.autoSwiper?.simulateDebuggerMouseClick?this.autoSwiper.simulateDebuggerMouseClick(t):t.click(),r.info("Bumble: Clicked match popup continue button");return}const s=document.getElementsByClassName("encounters-match__cta-action");if(s.length>1&&s[1]?.children[0]){this.autoSwiper?.simulateDebuggerMouseClick&&this.autoSwiper.simulateDebuggerMouseClick(s[1].children[0]),r.info("Bumble: Used fallback method to close match popup");return}this.autoSwiper?.simulateDebuugerKeyEvent&&this.autoSwiper?.keys?.escape&&(this.autoSwiper.simulateDebuugerKeyEvent(this.autoSwiper.keys.escape),this.autoSwiper.simulateDebuugerKeyEvent(this.autoSwiper.keys.escape),r.info("Bumble: Used escape key fallback to close match popup"))}catch(e){r.error("Bumble removeMessages error",{error:e.message})}}beelineCards=null;beelineCardIndex=0;getProfileCard(){try{if(window.location.href.includes("app/beeline")){let e=document.querySelector(".profile");return e||(this.beelineCards||(this.beelineCards=document.querySelectorAll(".user-card.has-hoverable-actions:not(.has-visible-actions)"),this.beelineCardIndex=0),this.beelineCards&&this.beelineCards.length>0&&this.beelineCardIndex<this.beelineCards.length?(this.beelineCards[this.beelineCardIndex].scrollIntoView(),this.autoSwiper?.simulateDebuggerMouseClick&&this.autoSwiper.simulateDebuggerMouseClick(this.beelineCards[this.beelineCardIndex]),this.beelineCardIndex++):(this.beelineCards=null,this.beelineCardIndex=0),null)}return document.querySelector(".encounters-user__frame")}catch(e){return r.error("Bumble getProfileCard error",{error:e.message}),null}}getName(){try{if(!this.profileCard)return r.warn("Bumble getName: profileCard not set"),"";if(window.location.href.includes("app/beeline")){const e=this.profileCard.querySelector(".profile__name");return e?e.innerText.trim():""}else{const e=this.profileCard.querySelector(".encounters-story-profile__name");return e?e.innerText.trim():""}}catch(e){return r.error("Bumble getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("Bumble getAge: profileCard not set"),"";if(window.location.href.includes("app/beeline")){const e=this.profileCard.querySelector(".profile__age");return e?e.innerText.trim().split(" ")[1]??"":""}else{const e=this.profileCard.querySelector(".encounters-story-profile__age");return e?e.innerText.trim().split(" ")[1]??"":""}}catch(e){return r.error("Bumble getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Bumble getHeight error",{error:e.message})}return null}getDistance(){let e=5e5;try{if(!this.profileCard)return r.warn("Bumble getDistance: profileCard not set"),e;const t=this.profileCard.querySelector(".location-widget__distance");if(t&&t.firstChild){const s=parseInt(t.firstChild.innerText.split(" ")[0].replace("~",""));Number.isInteger(s)&&(e=s)}}catch(t){r.error("Bumble getDistance error",{error:t.message})}return e}getLocation(){let e="";try{const t=document.querySelector(".location-widget__town");if(t){let s=t.innerText.split(",")[0];s&&(e=s)}}catch(t){r.error("Bumble getLocation error",{error:t.message})}return e}getProfileDescriptionText(){try{if(!this.profileCard)return r.warn("Bumble getProfileDescriptionText: profileCard not set"),"";const e=[];let t=null;return window.location.href.includes("app/beeline")?t=Array.from(this.profileCard.querySelectorAll(".profile__about")):t=Array.from(this.profileCard.querySelectorAll(".encounters-story-about__text")),e.push(t.map(s=>s.textContent.trim().toLowerCase()).join(" ")),e.join("")}catch(e){return r.error("Bumble getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{return this.profileCard?this.profileCard.innerText.toLowerCase():(r.warn("Bumble getProfileText: profileCard not set"),"")}catch(e){return r.error("Bumble getProfileText error",{error:e.message}),""}}getPhotoCount(){try{return window.location.href.includes("app/beeline")?document.querySelectorAll(".profile__photo").length:document.querySelectorAll(".media-box__picture-image").length}catch(e){return r.error("Bumble getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){try{if(!this.profileCard)return r.warn("Bumble getVerifiedStatus: profileCard not set"),!1;let e=null;return window.location.href.includes("app/beeline")?e=this.profileCard.querySelector(".profile__verify"):e=this.profileCard.querySelector(".encounters-story-profile__verification"),!!e}catch(e){return r.error("Bumble getVerifiedStatus error",{error:e.message}),!1}}getRecentlyActive(){return!0}getProfilePictureUrls(){return this.profileCard?U(this.profileCard.querySelectorAll(".media-box__picture-image")):(r.warn("Bumble getProfilePictureUrls: profileCard not set"),[])}supportRandomUsageSimulation=!0;doRandomUsageSimulation(){try{const e=Math.floor(Math.random()*700+300);setTimeout(()=>{this.autoSwiper?.simulateDebuugerKeyEvent&&this.autoSwiper?.keys?.arrowDown&&this.autoSwiper.simulateDebuugerKeyEvent(this.autoSwiper.keys.arrowDown)},e)}catch(e){r.error("Bumble doRandomUsageSimulation error",{error:e.message})}}reset(){}}class fe{autoSwiper=null;profileCard=null;getSiteName(){return"okcupid"}getSwipeSpeedModifier(){return 2}getElementForKeyEvents(){return window.body??document.body??document}swipeLeft(){try{let e=null;this.autoSwiper?.mobile?e=document.querySelector(".profile-buttons-actions-pass"):e=document.querySelector('[class="dt-action-buttons-button pass"]'),e?e.click():r.warn("OkCupid swipeLeft: pass-button not found")}catch(e){r.error("OkCupid swipeLeft error",{error:e.message})}}swipeRight(){try{let e=null;this.autoSwiper?.mobile?e=document.querySelector(".profile-buttons-actions-like"):e=document.querySelector('[class="dt-action-buttons-button like"]'),e?e.click():r.warn("OkCupid swipeRight: like-button not found")}catch(e){r.error("OkCupid swipeRight error",{error:e.message})}}removeMessages(){try{const e=document.querySelector(".dynamic-likes-cap-modal"),t=document.querySelector(".likes-cap-breather-modal");(e||t)&&this.autoSwiper&&(this.autoSwiper.stop=!0);let s=null,o=document.querySelector(".OkModalContent-main");if(o&&(s=o.querySelector(".likes-celebration-actions-anticta"),s&&s.click(),s=o.querySelector(".photo-requirements-cancel"),s&&s.click()),o=document.querySelector(".reactmodal-contents"),o&&(s=o.querySelector(".superlike-upgrade-your-like-dismiss"),s&&s.click()),s=document.querySelector(".connection-view-container-close-button"),s&&s.click(),o=document.querySelector(".FullscreenOverlay-inner"),o){let n=o.querySelectorAll("button");n&&n.length>1&&n[1].click()}if(s=document.querySelector(".profile-buttons-modal-buttons-cancel"),s){s.click();const n=document.querySelector("[href='/discover']");n&&n.hidden===!1&&n.click()}let i=document.querySelector('[data-cy="matchEvent.closeButton"]');i&&i.click()}catch(e){r.error("OkCupid removeMessages error",{error:e.message})}}getProfileCard(){try{if(!this.autoSwiper?.mobile){if(!window.location.href.includes("discover")){const t=document.querySelector("[href='/discover']");t&&t.hidden===!1&&t.click()}}let e=null;if(this.autoSwiper?.mobile)if(e=document.querySelector("#profile"),e===null){let t=document.querySelector(".i-arrow-down");t&&t.click()}else return e;else return document.querySelector(".desktop-dt-content")}catch(e){r.error("OkCupid getProfileCard error",{error:e.message})}return null}getName(){try{if(!this.profileCard)return r.warn("OkCupid getName: profileCard not set"),"";let e="",t=null;return this.autoSwiper?.mobile?t=this.profileCard.querySelector(".card-content-header__text"):t=this.profileCard.querySelector(".card-content-header__name-container"),t&&(e=t.innerText.trim()),e}catch(e){return r.error("OkCupid getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("OkCupid getAge: profileCard not set"),"";let e=0,t=this.profileCard.querySelector(".card-content-header__location");return t&&(e=t.innerText.split(" ")[0]),e}catch(e){return r.error("OkCupid getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("OkCupid getHeight error",{error:e.message})}return null}getDistance(){return 0}getLocation(){try{if(!this.profileCard)return r.warn("OkCupid getLocation: profileCard not set"),"";let e="",t=this.profileCard.querySelector(".card-content-header__location");return t&&(e=t.innerText.trim()?.split("‚Ä¢")[1]?.split(",")[0]?.trim()),e}catch(e){return r.error("OkCupid getLocation error",{error:e.message}),""}}getProfileDescriptionText(){try{if(!this.profileCard)return r.warn("OkCupid getProfileDescriptionText: profileCard not set"),"";let e="";return this.autoSwiper?.mobile?e=this.profileCard.querySelector(".profile-essay-contents"):e=this.profileCard.querySelector(".dt-essay"),e?e.innerText.trim().toLowerCase():""}catch(e){return r.error("OkCupid getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{if(!this.profileCard)return r.warn("OkCupid getProfileText: profileCard not set"),"";const e=[];e.push((this.getName()??"").toLowerCase());const t=this.getProfileDescriptionText();t&&e.push(t);const s=this.profileCard.querySelector(".matchprofile-details");return s&&e.push(s.innerText.trim().toLowerCase()),e.join(" ")}catch(e){return r.error("OkCupid getProfileText error",{error:e.message}),""}}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("OkCupid getProfilePictureUrls: profileCard not set"),[])}getPhotoCount(){try{if(!this.profileCard)return r.warn("OkCupid getPhotoCount: profileCard not set"),1;let e=null;return this.autoSwiper?.mobile?e=this.profileCard.querySelector(".tappy-thumbs-outer-container"):e=this.profileCard.querySelector(".sliding-pagination-inner-content"),e?.childNodes&&typeof e.childNodes.length=="number"&&e.childNodes.length||1}catch(e){return r.error("OkCupid getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){return!0}getRecentlyActive(){return!0}supportRandomUsageSimulation=!0;doRandomUsageSimulation(){try{const e=Math.floor(Math.random()*300+300),t=Math.floor(Math.random()*700+300);setTimeout(()=>{window.scroll({top:e,left:0,behavior:"smooth"})},t)}catch(e){r.error("OkCupid doRandomUsageSimulation error",{error:e.message})}}reset(){}}class me{autoSwiper=null;profileCard=null;getSiteName(){return"lovoo"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return document.querySelector(".modal-content")??document??window??document.body}removeProfileModal(){try{const e=document.querySelector(".modal-backdrop");e&&typeof e.hide=="function"&&e.hide();const t=document.querySelector(".modal-dialog");t&&typeof t.remove=="function"&&t.remove()}catch(e){r.error("Lovoo removeProfileModal error",{error:e.message})}}swipeLeft(){try{this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.escape&&(this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keypress",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keypress",this.autoSwiper.keys.escape));const e=document.querySelector('[data-automation-id="vote-no-button"]');e?e.click():r.warn("Lovoo swipeLeft: vote-no-button not found")}catch(e){r.error("Lovoo swipeLeft error",{error:e.message})}}swipeRight(){try{this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.escape&&(this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keypress",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keypress",this.autoSwiper.keys.escape));const e=document.querySelector('[data-automation-id="vote-yes-button"]');e?e.click():r.warn("Lovoo swipeRight: vote-yes-button not found")}catch(e){r.error("Lovoo swipeRight error",{error:e.message})}}removeMessages(){try{const e=document.querySelector('[data-automation-id="match-continue-playing-button"]');e&&e.click(),document.querySelector('[data-automation-id="match-booster-dialog"]')&&(this.autoSwiper&&(this.autoSwiper.stop=!0),this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.escape&&this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape))}catch(e){r.error("Lovoo removeMessages error",{error:e.message})}}getProfileCard(){try{if(this.autoSwiper?.stop)return null;const e=document.querySelector(".modal-content");if(e)return this.profileCard=e,e;if(!window.location.href.includes("match")){const s=document.querySelector("[href='/match']");s&&s.hidden===!1&&s.click()}const t=document.querySelector('[data-automation-id="match-user-profile-link"]');return t&&(t.click(),setTimeout(()=>{this.profileCard=document.querySelector(".modal-content")},100)),document.querySelector(".modal-content")}catch(e){return r.error("Lovoo getProfileCard error",{error:e.message}),null}}getName(){try{if(!this.profileCard)return r.warn("Lovoo getName: profileCard not set"),"";const e=this.profileCard.querySelector(".profile-details");return e&&e.children[0]?e.children[0].innerText.split(", ")[0]:""}catch(e){return r.error("Lovoo getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("Lovoo getAge: profileCard not set"),"";const e=this.profileCard.querySelector(".profile-details");return e&&e.children[0]?e.children[0].innerText.split(", ")[1]:""}catch(e){return r.error("Lovoo getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Lovoo getHeight error",{error:e.message})}return null}getDistance(){return 0}getLocation(){try{let e="";const t=document.querySelector('[ng-if="post.owner.locations.home.city"]');if(t){let s=t.innerText.trim();s.includes(" ")?e=s.split(" ")[1]:e=s}return e}catch(e){return r.error("Lovoo getLocation error",{error:e.message}),""}}getProfileDescriptionText(){try{if(!this.profileCard)return r.warn("Lovoo getProfileDescriptionText: profileCard not set"),"";const e=this.profileCard.querySelector(".tab-content");return e?e.querySelector('[ng-switch-when="false"]')?"":e.innerText:""}catch(e){return r.error("Lovoo getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{if(!this.profileCard)return r.warn("Lovoo getProfileText: profileCard not set"),"";const e=[];e.push((this.getName()??"").toLowerCase());const t=this.profileCard.querySelector('[ng-if="post.owner.locations.home.city"]');t&&e.push(t.innerText.trim().toLowerCase());const s=this.profileCard.querySelector(".tab-content");s&&e.push(s.innerText.trim().toLowerCase());const o=this.profileCard.querySelector(".media-list-devided");return o&&e.push(o.innerText.trim().toLowerCase()),e.join(" ")}catch(e){return r.error("Lovoo getProfileText error",{error:e.message}),""}}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("Lovoo getProfilePictureUrls: profileCard not set"),[])}getPhotoCount(){try{return this.profileCard?this.profileCard.querySelectorAll(".feed-post-image-container").length||1:(r.warn("Lovoo getPhotoCount: profileCard not set"),1)}catch(e){return r.error("Lovoo getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){try{const e=document.querySelector('[ng-switch="!!user.verified"]');return e?!!e.querySelector('[ng-switch-when="true"]'):!1}catch(e){return r.error("Lovoo getVerifiedStatus error",{error:e.message}),!1}}getRecentlyActive(){return!0}supportRandomUsageSimulation=!1;doRandomUsageSimulation(){}reset(){}}class we{autoSwiper=null;profileCard=null;newUi=!1;getSiteName(){return"badoo"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return document??window??document.body}swipeLeft(){try{if(window.location.href.includes("liked-you")){const e=document.querySelector(".profile-card-full__close");if(e){if(e.click(),this.likedYouCards&&this.likedYouCardIndex>0){const t=this.likedYouCards[this.likedYouCardIndex-1]?.querySelector(".csms-user-card-content__actions");t&&t.children[0]?t.children[0].click():r.warn("Badoo swipeLeft: actionBar or children[0] not found")}}else r.warn("Badoo swipeLeft: .vote-button--no not found");return}this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.Digit2?this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.Digit2):r.warn("Badoo swipeLeft: autoSwiper or keys.Digit2 not available")}catch(e){r.error("Badoo swipeLeft error",{error:e.message})}}swipeRight(){try{if(window.location.href.includes("liked-you")){const e=document.querySelector(".profile-card-full__close");if(e){if(e.click(),this.likedYouCards&&this.likedYouCardIndex>0){const t=this.likedYouCards[this.likedYouCardIndex-1]?.querySelector(".csms-user-card-content__actions");t&&t.children[1]?t.children[1].click():r.warn("Badoo swipeRight: actionBar or children[1] not found")}}else r.warn("Badoo swipeRight: closeButton not found");return}this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.Digit1?this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.Digit1):r.warn("Badoo swipeRight: autoSwiper or keys.Digit1 not available")}catch(e){r.error("Badoo swipeRight error",{error:e.message})}}removeMessages(){try{const e=document.querySelectorAll(".csms-actionsheet__list-item");e&&e.length>1&&e[1].children[0]&&e[1].children[0].click();const t=document.querySelector(".csms-screen");if(t){let g=t.querySelector('[data-qa="close-button"]');if(g){g.click();return}if(g=t.querySelector('[data-qa="profile-question-blocker-secondary"]'),g){g.click();return}if(g=t.querySelector('[data-qa-icon-name="navigation-bar-close"]'),g){g.click();return}}const s=document.querySelector(".mutual-attractions-wrapper");if(s){let g=s.querySelector('[data-qa-icon="navigation-bar-close"]');if(g){g.click();return}}const o=document.querySelector(".csms-modal");if(o){let g=o.querySelectorAll(".csms-action-row");if(g&&g.length>1){g[1].click();return}}if(document.querySelector(".encounters-card-no-results")){const g=document.querySelectorAll(".csms-tabbar__item")[0];g&&g.click()}if(document.querySelector(".promo-card")&&this.autoSwiper?.simulateMouseDragAndDropRightToLeft){const g=document.querySelector(".promo-card__inner");g&&this.autoSwiper.simulateMouseDragAndDropRightToLeft(g)}if(document.querySelector("[data-qa='promo-card-cta']")&&this.autoSwiper?.simulateMouseDragAndDropRightToLeft){const g=document.querySelector(".promo-card__inner");g&&this.autoSwiper.simulateMouseDragAndDropRightToLeft(g)}let u=document.querySelector(".overlay-page");if(u){let g=u.querySelectorAll(".csms-button");g&&g.length===2&&g[1].click()}const S=document.querySelector('[data-qa="modal-close"]');S&&S.click();let b=document.querySelector('[data-qa="modal-action-cancel"]');b&&b.click();const M=document.querySelector(".promo-card__close");M&&M.click()}catch(e){r.error("Badoo removeMessages error",{error:e.message})}}likedYouCards=null;likedYouCardIndex=0;getProfileCard(){try{if(window.location.href.includes("liked-you")){let t=document.querySelector(".profile-card-full");return t?(r.debug("Badoo: Profile found"),t):(this.likedYouCards||(r.debug("Badoo: Get liked you cards"),this.likedYouCards=document.querySelectorAll(".want-to-meet-you-grid__item:has(button:nth-of-type(2)):not(:has(button:nth-of-type(3)))"),this.likedYouCardIndex=0),this.likedYouCards&&this.likedYouCards.length>0&&this.likedYouCardIndex<this.likedYouCards.length?(r.debug("Badoo: Scroll to liked you card"),this.likedYouCards[this.likedYouCardIndex].scrollIntoView(),this.autoSwiper?.simulateDebuggerMouseClick&&this.autoSwiper.simulateDebuggerMouseClick(this.likedYouCards[this.likedYouCardIndex]),this.likedYouCardIndex++):(r.debug("Badoo: Reset liked you cards"),this.likedYouCards=null,this.likedYouCardIndex=0),null)}if(!window.location.href.includes("encounters")){const t=document.querySelector('[data-qa-icon-name="tabbar-encounters"]');t&&t.parentElement?.parentElement&&t.parentElement.parentElement.click()}return document.querySelector('[data-qa="first-card"]')}catch(e){return r.error("Badoo getProfileCard error",{error:e.message}),null}}getName(){try{return this.profileCard?this.profileCard.querySelector(".profile-card-info__name")?.querySelector('[data-qa="profile-info__name"]')?.innerText?.trim()??"":(r.warn("Badoo getName: profileCard not set"),"")}catch(e){return r.error("Badoo getName error",{error:e.message}),""}}getAge(){try{return this.profileCard?this.profileCard.querySelector(".profile-card-info__name")?.querySelector('[data-qa="profile-info__age"]')?.innerText?.trim()??"":(r.warn("Badoo getAge: profileCard not set"),"")}catch(e){return r.error("Badoo getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Badoo getHeight error",{error:e.message})}return null}getDistance(){return 0}getLocation(){try{const e=document.querySelector('[data-qa="location"]');if(e)return e.children[0]?.children[0]?.children[1]?.innerText??""}catch(e){r.error("Badoo getLocation error",{error:e.message})}return""}getProfileDescriptionText(){try{if(!this.profileCard)return r.warn("Badoo getProfileDescriptionText: profileCard not set"),"";const e=this.profileCard.querySelector(".profile-card-full__content");return e?e.innerText:""}catch(e){return r.error("Badoo getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{if(!this.profileCard)return r.warn("Badoo getProfileText: profileCard not set"),"";const e=[];e.push((this.getName()??"").toLowerCase());const t=this.profileCard.querySelector(".profile-card-full__content");return t&&e.push(t.innerText.trim().toLowerCase()),e.join(" ")}catch(e){return r.error("Badoo getProfileText error",{error:e.message}),""}}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("Badoo getProfilePictureUrls: profileCard not set"),[])}getPhotoCount(){try{if(!this.profileCard)return r.warn("Badoo getPhotoCount: profileCard not set"),1;const e=this.profileCard.querySelectorAll(".user-section--photo");if(e)return e.length}catch(e){return r.error("Badoo getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){try{return this.profileCard?!!this.profileCard.querySelector('[data-qa="verification-status-full"]'):(r.warn("Badoo getVerifiedStatus: profileCard not set"),!1)}catch(e){return r.error("Badoo getVerifiedStatus error",{error:e.message}),!1}}getRecentlyActive(){return!0}supportRandomUsageSimulation=!0;lastScroll=0;doRandomUsageSimulation(){try{if(!this.profileCard){r.warn("Badoo doRandomUsageSimulation: profileCard not set");return}const e=this.profileCard.querySelector(".profile-card__content-scroller"),t=Math.floor(Math.random()*1100+500)+this.lastScroll,s=Math.floor(Math.random()*500+500);this.lastScroll=t,e&&(e.scroll({top:t,left:0,behavior:"smooth"}),this.autoSwiper?.randomUsageCounter===this.autoSwiper?.radnomUsageNumber&&(setTimeout(()=>{e.scroll({top:0,left:0,behavior:"smooth"})},s),this.lastScroll=0))}catch(e){r.error("Badoo doRandomUsageSimulation error",{error:e.message})}}reset(){}}class Se{autoSwiper=null;profileCard=null;getSiteName(){return"pof"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return window.body??document.body??document}swipeLeft(){try{history.back(),setTimeout(()=>{const e=document.querySelector("#meetmevotebutton-no");e?e.click():r.warn("PoF swipeLeft: meetmevotebutton-no not found")},100)}catch(e){r.error("PoF swipeLeft error",{error:e.message})}}swipeRight(){try{history.back(),setTimeout(()=>{const e=document.querySelector("#meetmevotebutton-yes");e?e.click():r.warn("PoF swipeRight: meetmevotebutton-yes not found")},100)}catch(e){r.error("PoF swipeRight error",{error:e.message})}}removeMessages(){try{const e=document.querySelector(".upgrade-like-to-like-plus-container");if(e){const t=e.querySelector("a");t&&t.click()}}catch(e){r.error("PoF removeMessages error",{error:e.message})}}getProfileCard(){try{if(!window.location.href.includes("meetme")){const e=document.querySelector("[href='/meetme']");if(e&&e.hidden===!1)return e.click(),null}if(window.location.href.includes("viewprofile"))return document.querySelector("#main-content");{const e=document.querySelector("#meetme-stack"),t=e?e.querySelector("a"):null;t&&t.click()}}catch(e){r.error("PoF getProfileCard error",{error:e.message})}return null}getProfileInfosElement(){try{const e=document.querySelector("#profile-banner");if(e){const t=e.children[0]?.children[1]?.children[0]?.children[0]?.children[0]?.children[2]?.children[0]?.children[0];if(t)return t}}catch(e){r.error("PoF getProfileInfosElement error",{error:e.message})}return null}getName(){try{const e=this.getProfileInfosElement();if(e&&e.children[0])return e.children[0].innerText.trim()}catch(e){r.error("PoF getName error",{error:e.message})}return""}getAge(){try{if(!this.profileCard)return r.warn("PoF getName: profileCard not set"),"";const e=this.profileCard.querySelector("#profile-banner"),t=e?e.querySelector("#attributelist-item-age"):null;if(t&&t.children[1])return t.children[1].innerText}catch(e){r.error("PoF getAge error",{error:e.message})}return""}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("PoF getHeight error",{error:e.message})}return null}getDistance(){return 0}getLocation(){try{if(!this.profileCard)return r.warn("PoF getAge: profileCard not set"),"";const e=this.profileCard.querySelector("#profile-banner"),t=e?e.querySelector("#attributelist-item-location"):null;if(t&&t.children[1])return t.children[1].innerText.split(",")[0]}catch(e){r.error("PoF getLocation error",{error:e.message})}return""}getProfileDescriptionText(){try{return this.profileCard?this.profileCard.innerText.trim():(r.warn("PoF getProfileDescriptionText: profileCard not set"),"")}catch(e){return r.error("PoF getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{return this.profileCard?this.profileCard.innerText.trim():(r.warn("PoF getProfileText: profileCard not set"),"")}catch(e){return r.error("PoF getProfileText error",{error:e.message}),""}}getPhotoCount(){try{return this.profileCard?this.profileCard.querySelectorAll('[id^="profile-image-wrapper-"]').length/2:(r.warn("PoF getPhotoCount: profileCard not set"),1)}catch(e){return r.error("PoF getPhotoCount error",{error:e.message}),1}}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("PoF getProfilePictureUrls: profileCard not set"),[])}getVerifiedStatus(){return!0}getRecentlyActive(){return!0}supportRandomUsageSimulation=!0;doRandomUsageSimulation(){try{const e=Math.floor(Math.random()*300+300),t=Math.floor(Math.random()*700+300);setTimeout(()=>{window.scroll({top:e,left:0,behavior:"smooth"})},t)}catch(e){r.error("PoF doRandomUsageSimulation error",{error:e.message})}}reset(){}}class ye{autoSwiper=null;profileCard=null;getSiteName(){return"zoosk"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return window??document??document.body}swipeLeft(){try{if(!this.profileCard)return r.warn("Zoosk swipeLeft: profileCard not set"),!1;const e=this.profileCard.querySelector(".profile-card-v2-button-no");e?e.click():r.warn("Zoosk swipeLeft: .profile-card-v2-button-no not found"),this.clickNextProfileBtn()}catch(e){return r.error("Zoosk swipeLeft error",{error:e.message}),!1}}swipeRight(){try{if(!this.profileCard)return r.warn("Zoosk swipeRight: profileCard not set"),!1;const e=this.profileCard.querySelector(".profile-card-v2-button-yes");e?e.click():r.warn("Zoosk swipeRight: .profile-card-v2-button-yes not found"),this.clickNextProfileBtn()}catch(e){return r.error("Zoosk swipeRight error",{error:e.message}),!1}}clickNextProfileBtn(){try{if(!this.profileCard){r.warn("Zoosk clickNextProfileBtn: profileCard not set");return}const e=this.profileCard.querySelector(".slide-nav-v3__next");e&&e.click()}catch(e){r.error("Zoosk clickNextProfileBtn error",{error:e.message})}}removeMessages(){try{document.querySelector(".encounters-user__blocker")&&this.autoSwiper&&(this.autoSwiper.stop=!0);const t=document.getElementsByClassName("encounters-match__cta-action");t.length>1&&t[1]?.children[0]&&t[1].children[0].click(),this.autoSwiper?.simulateKeyEvent&&this.autoSwiper?.keys?.escape&&(this.autoSwiper.simulateKeyEvent("keyup",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keydown",this.autoSwiper.keys.escape),this.autoSwiper.simulateKeyEvent("keypress",this.autoSwiper.keys.escape))}catch(e){r.error("Zoosk removeMessages error",{error:e.message})}}getProfileCard(){try{return document.querySelector("[data-zat=current-card-true]")}catch(e){return r.error("Zoosk getProfileCard error",{error:e.message}),null}}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("Zoosk getProfilePictureUrls: profileCard not set"),[])}getName(){try{if(!this.profileCard)return r.warn("Zoosk getName: profileCard not set"),"";const e=this.profileCard.querySelector("[data-zat=profile-other-user-name-and-age]");return e?e.innerText.trim().split(", ")[0]:""}catch(e){return r.error("Zoosk getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("Zoosk getAge: profileCard not set"),"";const e=this.profileCard.querySelector("[data-zat=profile-other-user-name-and-age]");return e?e.innerText.trim().split(", ")[1]:""}catch(e){return r.error("Zoosk getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Zoosk getHeight error",{error:e.message})}return null}getDistance(){let e=5e5;try{if(!this.profileCard)return r.warn("Zoosk getDistance: profileCard not set"),e;const t=this.profileCard.querySelector("[data-zat=profile-other-user-location]"),s=t?t.innerText.trim():"";if(s&&s.includes("(")){const o=parseInt(s.split("(")[1].split(" ")[0]);Number.isInteger(o)&&(e=o)}}catch(t){r.error("Zoosk getDistance error",{error:t.message})}return e}getLocation(){try{if(!this.profileCard)return r.warn("Zoosk getLocation: profileCard not set"),"";const e=this.profileCard.querySelector("[data-zat=profile-other-user-location]"),t=e?e.innerText.trim():"";return t&&t.includes("(")?t.split("(")[0].trim():t}catch(e){return r.error("Zoosk getLocation error",{error:e.message}),""}}getProfileDescriptionText(){try{const e=[],t=document.querySelectorAll(".extended-info")[1];if(t){const s=t.querySelector(".basics-v2-list");s&&e.push(s.innerText.replaceAll(`
`," "))}return e.join(" ")}catch(e){return r.error("Zoosk getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{if(!this.profileCard)return r.warn("Zoosk getProfileText: profileCard not set"),"";const e=[];e.push((this.getName()??"").toLowerCase()),e.push(this.getProfileDescriptionText());const t=this.profileCard.querySelector("[data-zat=profile-other-user-location]");return t&&e.push(t.innerText.trim()),e.join(" ")}catch(e){return r.error("Zoosk getProfileText error",{error:e.message}),""}}getPhotoCount(){try{return this.profileCard?this.profileCard.querySelectorAll(".photo-counter").length:(r.warn("Zoosk getPhotoCount: profileCard not set"),1)}catch(e){return r.error("Zoosk getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){try{return this.profileCard?!!this.profileCard.querySelector(".profile-card-icon--video-verified"):(r.warn("Zoosk getVerifiedStatus: profileCard not set"),!1)}catch(e){return r.error("Zoosk getVerifiedStatus error",{error:e.message}),!1}}getRecentlyActive(){return!0}reset(){}}class be{autoSwiper=null;profileCard=null;getSiteName(){return"match"}getSwipeSpeedModifier(){return 1}getElementForKeyEvents(){return window??document??document.body}swipeLeft(){try{const e=document.querySelector('[data-test="dislike-text-button"]');e?e.click():r.warn("Match swipeLeft: dislike-text-button not found")}catch(e){r.error("Match swipeLeft error",{error:e.message})}}swipeRight(){try{const e=document.querySelector('[data-test="like-icon-button"]');e?e.click():r.warn("Match swipeRight: like-icon-button not found")}catch(e){r.error("Match swipeRight error",{error:e.message})}}removeMessages(){try{const e=document.querySelector('[data-test="layer-mask-close-icon"]');e&&e.click()}catch(e){r.error("Match removeMessages error",{error:e.message})}}beelineCards=null;beelineCardIndex=0;getProfileCard(){try{const e=document.querySelector('[data-test="profile-page"]');if(e)return e;const t=document.querySelector('[data-test="feed-card-info"]');t?t.click():r.warn("Match getProfileCard: feed-card-info button not found")}catch(e){r.error("Match getProfileCard error",{error:e.message})}return null}getProfilePictureUrls(){return this.profileCard?U(this.profileCard):(r.warn("Match getProfilePictureUrls: profileCard not set"),[])}getName(){try{if(!this.profileCard)return r.warn("Match getName: profileCard not set"),"";const e=this.profileCard.querySelector("[class^='profile-details-nickname__NicknameContainer']");return e?e.innerText.trim():""}catch(e){return r.error("Match getName error",{error:e.message}),""}}getAge(){try{if(!this.profileCard)return r.warn("Match getAge: profileCard not set"),"";const e=this.profileCard.querySelector("[class^='profile-details-age-city__Age']");return(e?e.textContent:"200").match(/\d+/)?.[0]??""}catch(e){return r.error("Match getAge error",{error:e.message}),""}}getHeight(){try{const e=this.getProfileText(),t=/(\d{1,3}\s?cm)|(\d'?\d{0,2})'(\d{0,2})"?/g,s=e.match(t);if(s){const o=s[0];if(o.includes("cm"))return parseInt(o);{const[i,n]=o.split("'"),u=(parseInt(i)*12+(n?parseInt(n.replace('"',"")):0))*2.54;return Math.round(u)}}}catch(e){r.error("Match getHeight error",{error:e.message})}return null}getDistance(){try{if(!this.profileCard)return r.warn("Match getDistance: profileCard not set"),5e5;const e=this.profileCard.querySelector("[data-test='dealbreaker-distance']");return(e?e.textContent:"500000").match(/\d+/)?.[0]??"500000"}catch(e){return r.error("Match getDistance error",{error:e.message}),5e5}}getLocation(){try{if(!this.profileCard)return r.warn("Match getPhotoCount: profileCard not set"),"";const e=this.profileCard.querySelector("[class^='profile-details-age-city__City']");return e?e.textContent.trim():""}catch(e){return r.error("Match getLocation error",{error:e.message}),""}}getProfileDescriptionText(){try{return this.profileCard?this.profileCard.innerText.toLowerCase():(r.warn("Match getProfileDescriptionText: profileCard not set"),"")}catch(e){return r.error("Match getProfileDescriptionText error",{error:e.message}),""}}getProfileText(){try{return this.profileCard?this.profileCard.innerText.toLowerCase():(r.warn("Match getProfileText: profileCard not set"),"")}catch(e){return r.error("Match getProfileText error",{error:e.message}),""}}getPhotoCount(){try{const e=document.querySelector(".gallery-more-buttonstyle__MoreButton-sc-1bicwrw-0"),s=(e?e.textContent:"0").match(/\d+/)?.[0],o=document.querySelectorAll("[class^='gallery-placeholderstyle__GalleryPlaceholder']"),i=o?o.length:0;return s?parseInt(s)+3:4-parseInt(i)}catch(e){return r.error("Match getPhotoCount error",{error:e.message}),1}}getVerifiedStatus(){return!1}getRecentlyActive(){return!0}supportRandomUsageSimulation=!0;doRandomUsageSimulation(){try{const e=document.querySelector("[class^='scrollablestyle__ScrollableContainer']"),t=Math.floor(Math.random()*700+300),s=Math.floor(Math.random()*700+300);e&&typeof e.scroll=="function"&&e.scroll({top:t,left:0,behavior:"smooth"})}catch(e){r.error("Match doRandomUsageSimulation error",{error:e.message})}}reset(){}}class oe{version=null;site=null;sessionStartedAt=null;sessionEndedAt=null;cardTries={cardTryCounter:0,cardTryReloadCounter:0,sameProfileFoundCounter:0,sameProfileFoundReloadCounter:0,lastProfile:null,lastLastProfile:null};stop=!1;userStopped=!1;ignoreUnload=!1;swipeCounts={total:0,left:0,right:0};nextSwipes=[];swipeCount=0;reloadPageAtSwipes=null;breakAtSwipes=null;breakDuration=null;lastSessionUpdate=0;sessionUpdateInterval=20;longitude=null;latitude=null;options={uuid:null,sessionId:null,userId:null,userEmail:"",isFree:!0,isBasic:!1,isPro:!1,isUltimate:!1,site:null,enableMaxSwipesFilter:!1,maxSwipes:100,forceMatch:!1,enableLeftSwipesPercentageFilter:!1,leftSwipePercentage:[25,50],enableAgeFilter:!1,minMaxAge:[18,99],enableHeightFilter:!1,minMaxHeight:[155,180],enableDistanceFilter:!1,maxDistance:10,skipEmptyDistance:!1,enableMinPicturesFilter:!1,minPictures:2,minMaxSwipeTime:[2,6],enableBreak:!1,breakBetweenSwipes:[150,250],breakDuration:[20,360],enableAutomaticPageReload:!1,reloadPageBetweenSwipes:[150,200],enableDelayAfterPageReload:!1,delayBetweenAfterPageReload:[120,720],delayAfterPageReload:null,enableRandomUsageSimulation:!0,randomUsageSimulation:[1,4],enableGatheringPictureUrls:!1,noEmptyDescription:!1,onlyVerifyedProfiles:!1,onlyRecentlyActive:!1,bannedWords:[],preferredWords:[],requiredWords:[],stats:{swipes_left:0,swipes_right:0,bannedWords:{},preferredWords:{},requiredWords:{}},log:[],swipeLog:[],tabId:null,withNotification:!0,stopOnRightSwipe:!1};profile={datetime:"",reason:"",name:"",age:0,height:0,distance:0,location:"",photosCount:0,description:"",verifyed:!1,pictures:[]};keys={arrowLeft:{key:"ArrowLeft",code:"ArrowLeft",keyCode:37,which:37,charCode:0},arrowUp:{key:"ArrowUp",code:"ArrowUp",keyCode:38,which:38,charCode:0},arrowRight:{key:"ArrowRight",code:"ArrowRight",keyCode:39,which:39,charCode:0},arrowDown:{key:"ArrowDown",code:"ArrowDown",keyCode:40,which:40,charCode:0},escape:{key:"Escape",keyCode:27,code:27},Digit1:{key:"1",code:"Digit1",keyCode:49,which:49,charCode:49},Digit2:{key:"2",code:"Digit2",keyCode:50,which:50,charCode:50}};mobile=!1;forcedMatchProgress={left:!1,right:!1,reload:!1};constructor(e){this.options=e,this.setSite(),this.setMobile(),this.version=c.runtime.getManifest().version,this.regenerateRandomSettings(),this.fetchLocation(),r.debug("AutoSwiper Settings for this RUN",{options:this.options})}formatDateTime(e){return e.toLocaleString("sv-SE",{hour12:!1})}regenerateRandomSettings(){this.breakAtSwipes=Math.round(this.getRandom(this.options.breakBetweenSwipes[0],this.options.breakBetweenSwipes[1])),this.breakDuration=Math.round(this.getRandom(this.options.breakDuration[0],this.options.breakDuration[1])),this.options.enableBreak&&r.info("automatic break configured",{breakAtSwipes:this.breakAtSwipes,breakDurationMinutes:this.breakDuration}),this.reloadPageAtSwipes=Math.round(this.getRandom(this.options.reloadPageBetweenSwipes[0],this.options.reloadPageBetweenSwipes[1])),this.options.delayAfterPageReload=Math.round(this.getRandom(this.options.delayBetweenAfterPageReload[0],this.options.delayBetweenAfterPageReload[1])),this.options.enableAutomaticPageReload&&r.info("automatic page reload configured",{reloadAtSwipes:this.reloadPageAtSwipes,delayAfterReloadMinutes:this.options.delayAfterPageReload}),this.regenerateRandomUsageNumber()}regenerateRandomUsageNumber(){this.radnomUsageNumber=Math.floor(this.getRandom(this.options.randomUsageSimulation[0],this.options.randomUsageSimulation[1]))}getRandom(e,t){return Math.random()*(t-e)+e}async getDistanceFromApi(){(this.latitude===null||this.longitude===null)&&this.fetchLocation();const e=z+`?from_latitude=${this.latitude}&from_longitude=${this.longitude}&to_location_query=${this.profile.location}`,t=await c.storage.local.get("loginToken");let s=await fetch(e,{headers:{Authorization:`Bearer ${t.loginToken}`}});if(!s.ok)return r.error("Distance API HTTP error",{status:s.status}),0;let o=await s.json();return r.debug("Distance API response",{location:this.profile.location,distance:o.distance}),o.distance}async startSessionOnApi(){const e=await c.storage.local.get(["loginToken","instanceRegistered"]);if(e.loginToken&&!this.options.isFree)try{const{startSession:t}=await Promise.resolve().then(()=>q),s={site:this.site.getSiteName(),scheduled_session_id:this.options.scheduledSessionId||null},o={loginToken:e.loginToken,uuid:this.options.uuid},i=await t(s,o,null,null);return i&&i.status&&i.data&&i.data.session_id?(r.info("Started authenticated session",{sessionId:i.data.session_id}),i.data.session_id):(r.error("Invalid response from startSession",{response:i}),null)}catch(t){return r.error("Error starting authenticated session",{error:t.message}),null}return this.options.uuid?(e.instanceRegistered||await this.registerFreeUserInstance(this.options.uuid),await this.startFreeUserSession(this.options.uuid)):(r.warn("No UUID found, cannot start session"),null)}async registerFreeUserInstance(e){try{const{registerFreeUserInstance:t}=await Promise.resolve().then(()=>q),s=await t(e);return s&&s.status?(await c.storage.local.set({instanceRegistered:!0}),r.info("Free user instance registered successfully"),!0):(r.error("Failed to register free user instance",{response:s}),!1)}catch(t){return r.error("Error registering free user instance",{error:t.message}),!1}}async startFreeUserSession(e){try{const{startFreeUserSession:t}=await Promise.resolve().then(()=>q),s={site:this.site.getSiteName(),scheduled_session_id:this.options.scheduledSessionId||null},o=await t(e,s);return o&&o.status&&o.data&&o.data.session_id?(r.info("Free user session started",{sessionId:o.data.session_id}),o.data.session_id):(r.error("Failed to start free user session",{response:o}),null)}catch(t){return r.error("Error starting free user session",{error:t.message}),null}}async addSessionToApi(){r.debug("Ending session",{sessionId:this.options.sessionId,swipeCount:this.swipeCounts.total});const e=await c.storage.local.get(["loginToken"]);this.sessionStartedAt||this.formatDateTime(new Date);const t=this.sessionEndedAt||this.formatDateTime(new Date);if(this.options.sessionId){r.info("Ending session with unified approach",{sessionId:this.options.sessionId});const s={swipes_left:this.swipeCounts.left,swipes_right:this.swipeCounts.right,swipes_total:this.swipeCounts.total,logs:this.options.swipeLog,ended_at:t,status:"completed"};if(e.loginToken&&!this.options.isFree)try{const{endSession:o}=await Promise.resolve().then(()=>q),i={loginToken:e.loginToken,uuid:this.options.uuid},n=await o(this.options.sessionId,s,i,null,null);r.info("Authenticated session ended successfully");try{m.clearSession(),r.debug("Session backup cleared after successful authenticated session send")}catch(l){r.error("Failed to clear session backup",{error:l.message})}return}catch(o){r.error("Error ending authenticated session",{error:o.message});const i={swipes_left:this.swipeCounts.left,swipes_right:this.swipeCounts.right,swipes_total:this.swipeCounts.total,logs:this.options.swipeLog,ended_at:new Date().toISOString(),status:"failed",failure_reason:"Session completion failed",error_details:{message:o.message,stack:o.stack}};try{const{endSession:n}=await Promise.resolve().then(()=>q);await n(this.options.sessionId,i,mockStore,null,null),r.info("Session marked as failed due to completion error");try{m.clearSession(),r.debug("Session backup cleared after marking session as failed")}catch(l){r.error("Failed to clear session backup after failure",{error:l.message})}return}catch(n){r.error("Failed to end session with failed status",{error:n.message})}}else if(this.options.uuid)try{await this.endFreeUserSession(this.options.uuid,this.options.sessionId,s),r.info("Free user session ended successfully");try{m.clearSession(),r.debug("Session backup cleared after successful free user session send")}catch(o){r.error("Failed to clear session backup",{error:o.message})}return}catch(o){r.error("Error ending free user session",{error:o.message});const i={swipes_left:this.swipeCounts.left,swipes_right:this.swipeCounts.right,swipes_total:this.swipeCounts.total,logs:this.options.swipeLog,ended_at:new Date().toISOString(),status:"failed",failure_reason:"Free user session completion failed",error_details:{message:o.message,stack:o.stack}};try{await this.endFreeUserSession(this.options.uuid,this.options.sessionId,i),r.info("Free user session marked as failed");try{m.clearSession(),r.debug("Session backup cleared after marking free user session as failed")}catch(n){r.error("Failed to clear session backup after failure",{error:n.message})}return}catch(n){r.error("Failed to end free user session with failed status",{error:n.message})}}}r.error("No session ID available - session must be started with startSession() first")}async endFreeUserSession(e,t,s){try{const{endFreeUserSession:o}=await Promise.resolve().then(()=>q),i=await o(e,t,s);return i&&i.status?(r.info("Free user session ended successfully"),!0):(r.error("Failed to end free user session",{response:i}),!1)}catch(o){return r.error("Error ending free user session",{error:o.message}),!1}}async loadProfileData(){this.profile.datetime=new Date().toISOString(),this.profile.name=this.site.getName(),this.profile.age=this.site.getAge(),this.profile.height=this.site.getHeight(),this.profile.distance=this.site.getDistance(),this.profile.location=this.site.getLocation(),(this.options.isPro||this.options.isUltimate)&&this.profile.location.length>0&&(this.profile.distance===0||this.profile.distance===5e5)&&(this.profile.distance=await this.getDistanceFromApi()),this.profile.photosCount=this.site.getPhotoCount(),r.debug("photos count",{count:this.profile.photosCount}),this.profile.description=this.site.getProfileDescriptionText(),this.profile.texts=this.site.getProfileText(),this.profile.verifyed=this.site.getVerifiedStatus(),this.options.enableGatheringPictureUrls?this.profile.pictures=await this.site.getProfilePictureUrls():this.profile.pictures=[],r.debug("pictures urls",{pictures:this.profile.pictures})}getWords(e){const t=[],s=this.options[e],o=this.options.stats[e]||{};return this.profile.texts===void 0?this.profile.texts:(r.debug("searching for words",{type:e,wordList:s}),s.find(i=>{let n=!1,l=null;if(i.startsWith("/")&&i.endsWith("/"))try{l=new RegExp(i.slice(1,-1))}catch(u){r.error("Error processing words",{error:u.message})}l instanceof RegExp?(r.debug("Content: Regex Search",{regex:l.toString()}),n=l.test(this.profile.texts)):(r.debug("Content: String Search",{word:i}),n=this.profile.texts.toLowerCase().search(i.toLowerCase())!==-1||i==="@"&&this.profile.texts.toLowerCase().search(i.toLowerCase())!==-1),n&&(o[i]===void 0&&(o[i]=0),o[i]++,t.push(i))}),t?.length>0&&r.debug(`Content: found ${e} words`,{type:e,words:t}),this.options.stats[e]=o,t)}getBannedWords(){return this.getWords("bannedWords")}getPreferredWords(){return this.getWords("preferredWords")}getRequiredWords(){return this.getWords("requiredWords")}createMarkerAt(e,t,s){const o=document.createElement("div");o.style.position="absolute",o.style.left=`${e}px`,o.style.top=`${t}px`,o.style.width="10px",o.style.height="10px",o.style.backgroundColor="red",o.style.color="white",o.style.textAlign="center",o.style.borderRadius="50%",o.style.zIndex="1000",o.innerText=s,document.body.appendChild(o)}simulateMouseDragAndDropRightToLeft(e){const t=e.getBoundingClientRect(),s=this.getRandom(60,200),o=this.getRandom(-120,120),i=this.getRandom(120,220),n=this.getRandom(-120,120),l=t.left+(t.right-t.left)/2+s,u=t.top+(t.bottom-t.top)/2+o,S=t.left+(t.right-t.left)/2-i,b=t.top+(t.bottom-t.top)/2+n;this.simulateMouseDragAndDrop(e,l,u,S,b)}simulateMouseDragAndDrop(e,t,s,o,i){function n(b,M,g){return new MouseEvent(b,{bubbles:!0,cancelable:!0,clientX:M,clientY:g,view:window})}const l=n("mousedown",t,s);e.dispatchEvent(l);const u=n("mousemove",o,i);e.dispatchEvent(u);const S=n("mouseup",o,i);e.dispatchEvent(S)}simulateKeyEvent(e,t){const s=new KeyboardEvent(e,{char:"",shiftKey:!1,bubbles:!0,cancelable:!0,...t}),o=this.site.getElementForKeyEvents();o&&o.dispatchEvent(s)}simulateDebuugerKeyEvent(e){r.debug("Content: sent auto-swiper-message-backgroundjs-simulate-key-event",{keyData:e}),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-simulate-key-event",tabId:this.options.tabId,keyData:e})}simulateDebuggerMouseClick(e){const t=e.getBoundingClientRect(),s=12,o=t.left+(t.right-t.left)/2+(Math.random()*2*s-s),i=t.top+(t.bottom-t.top)/2+(Math.random()*2*s-s);r.debug("Content: sent auto-swiper-message-backgroundjs-simulate-mouse-click",{x,y}),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-simulate-mouse-click",tabId:this.options.tabId,x:o,y:i})}addLog(){this.options.swipeLog.push(this.profile)}resetAfterSwipe(){this.regenerateRandomUsageNumber()}swipe(e){this.swipeCounts.total++,this.swipeCounts[e]++,this.options.stats[`swipes_${e}`]++,this.addLog(),r.info(`Content: Swipe #${this.swipeCounts.total} - ${e==="left"?"LEFT":"RIGHT"}`,{swipeCount:this.swipeCounts.total,direction:e,profile:{name:this.profile.name,age:this.profile.age,height:this.profile.height,distance:this.profile.distance,photosCount:this.profile.photosCount},reason:this.profile.reason}),this.cardTries.lastLastProfile={...this.cardTries.lastProfile},this.cardTries.lastProfile={...this.profile},this.site[`swipe${e.charAt(0).toUpperCase()+e.slice(1)}`](),this.site.reset(),this.shouldSendSessionUpdate()&&this.sendSessionUpdate(),this.debouncedSaveBackup()}swipeLeft(){this.swipe("left")}swipeRight(){if(this.options.stopOnRightSwipe){this.stop=!0,this.ignoreUnload=!0;return}this.swipe("right")}resetProfile(){this.profile={datetime:"",reason:null,name:"",age:0,distance:0,photosCount:0},this.site.removeMessages()}debouncedSaveBackup=m.debounce(()=>{try{if(r.debug("Content: debouncedSaveBackup called",{sessionStartedAt:this.sessionStartedAt,hasSessionId:!!this.options.sessionId,swipeCount:this.swipeCounts.total,site:this.site?.getSiteName()}),!this.sessionStartedAt){r.warn("Content: No active session to backup - sessionStartedAt is null/undefined");return}r.debug("Content: Creating session data for backup");const e=m.createSessionData(this,"active");if(r.debug("Content: Session data created",{sessionId:e.sessionId,site:e.site,swipeCount:e.swipeCounts?.total,hasSwipeLog:!!e.swipeLog,swipeLogLength:e.swipeLog?.length||0,status:e.status,uuid:e.uuid}),r.debug("Content: Calling SessionManager.saveSession"),m.saveSession(e)){r.info("Content: Session backup saved",{sessionId:e.sessionId,swipeCount:e.swipeCounts.total});const s=m.getSession();s?r.debug("Content: Backup verification successful",{retrievedSessionId:s.sessionId,retrievedSwipeCount:s.swipeCounts?.total}):r.error("Content: Backup verification failed - no data retrieved after save")}else r.error("Content: SessionManager.saveSession returned false")}catch(e){r.error("Content: Failed to save session backup",{error:e.message,errorName:e.name,stack:e.stack})}},500);shouldSendSessionUpdate(){return this.swipeCounts.total-this.lastSessionUpdate>=this.sessionUpdateInterval&&this.options.sessionId}async sendSessionUpdate(){if(!this.options.sessionId){r.debug("Content: No session ID available for update");return}try{r.info("Content: Sending session update",{sessionId:this.options.sessionId,swipeCount:this.swipeCounts.total,swipesSinceLastUpdate:this.swipeCounts.total-this.lastSessionUpdate});const e=m.createSessionData(this,"active"),s={loginToken:(await c.storage.local.get(["loginToken"])).loginToken||null,uuid:this.options.uuid,isFree:this.options.isFree};await m.updateSession(e,s),this.lastSessionUpdate=this.swipeCounts.total,r.info("Content: Session update sent successfully",{sessionId:this.options.sessionId,currentSwipeCount:this.swipeCounts.total})}catch(e){r.error("Content: Failed to send session update",{error:e.message,sessionId:this.options.sessionId,swipeCount:this.swipeCounts.total})}}setSite(){const e={bumble:he,tinder:pe,okcupid:fe,lovoo:me,badoo:we,pof:Se,zoosk:ye,match:be},t=Object.keys(e).find(o=>window.location.href.includes(o)),s=e[t];if(s){const o=new s;o.autoSwiper=this,this.site=o}}setMobile(){this.mobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}cardNotFound(){this.cardTries.cardTryCounter>5?(this.ignoreUnload=!0,this.cardTries.cardTryCounter=0,this.cardTries.cardTryReloadCounter>3?this.sendMessageToApp("ERROR_SWIPING_NOT_WORKING"):(r.warn("Content: no card found, auto reload page",{reloadCounter:this.cardTries.cardTryReloadCounter,attempt:this.cardTries.cardTryReloadCounter+1}),this.cardTries.cardTryReloadCounter++,m.clearSession(),r.debug("Content: Cleared session backup before intentional reload"),r.debug("Content: sent auto-swiper-message-backgroundjs-reload-tab"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-reload-tab",swipeCounts:this.swipeCounts,options:this.options,swipeLog:this.options.swipeLog,tabId:this.options.tabId,cardTries:this.cardTries}))):this.cardTries.cardTryCounter++}sameProfileFound(){this.cardTries.sameProfileFoundCounter>5?(r.error("Content: same card as last time - something is wrong",{sameProfileFoundCounter:this.cardTries.sameProfileFoundCounter}),this.ignoreUnload=!0,this.cardTries.sameProfileFoundCounter=0,this.cardTries.lastProfile=null,this.cardTries.lastLastProfile=null,this.cardTries.sameProfileFoundReloadCounter>3?this.sendMessageToApp("ERROR_SWIPING_NOT_WORKING"):(r.warn("Content: same card as last time, auto reload page",{reloadCounter:this.cardTries.sameProfileFoundReloadCounter,attempt:this.cardTries.sameProfileFoundReloadCounter+1}),this.cardTries.sameProfileFoundReloadCounter++,m.clearSession(),r.debug("Content: Cleared session backup before intentional reload"),r.debug("Content: sent auto-swiper-message-backgroundjs-reload-tab"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-reload-tab",swipeCounts:this.swipeCounts,options:this.options,swipeLog:this.options.swipeLog,tabId:this.options.tabId,cardTries:this.cardTries}))):(r.warn("Content: same card as last time",{attempt:this.cardTries.sameProfileFoundCounter+1,sameProfileFoundCounter:this.cardTries.sameProfileFoundCounter}),this.cardTries.sameProfileFoundCounter++)}getProfileCard(){let e=null;try{e=this.site.getProfileCard(),e?(this.cardTries.cardTryCounter=0,this.cardTries.cardFoundCounter=0):this.cardNotFound()}catch(t){r.error("Content: Error getting profile card",{error:t.message}),this.cardNotFound()}return e}sendMessageToApp(e){r.debug("Content: sent auto-swiper-message-popupjs-show-message",{message:e}),c.runtime.sendMessage({action:"auto-swiper-message-popupjs-show-message",message:e})}distributeSwipesEvenly(e,t){let s=[],o=e.length/(e.length+t.length),i=1-o,n=0,l=0;for(let u=0;u<e.length+t.length;u++)u*o>=n&&n<e.length?(s.push(e[n]),n++):u*i>=l&&l<t.length&&(s.push(t[l]),l++);return s}getCurrentLocation(){return new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t)})}async fetchLocation(){const e=await c.storage.local.get({longitude:null,latitude:null});if(e.longitude!==null&&e.latitude!==null)this.longitude=e.longitude,this.latitude=e.latitude;else try{const t=await this.getCurrentLocation();this.longitude=t.coords.latitude,this.latitude=t.coords.latitude}catch(t){r.warn("Could not get current position",{error:t.message})}r.debug("Location coordinates",{latitude:this.latitude,longitude:this.longitude})}async check(){if(r.debug("Starting profile check",{profileName:this.profile?.name||"Unknown"}),this.options.enableMaxSwipesFilter&&this.options.maxSwipes===this.swipeCounts.total&&(this.stop=!0,this.ignoreUnload=!0,r.info("max swipes reached, stopping auto swiper")),this.options.isFree===!0&&this.swipeCounts.total===100&&(this.stop=!0,this.ignoreUnload=!0,r.info("swipe limit reached for free users, stopping auto swiper")),this.options.isBasic===!0&&this.swipeCounts.total===1e3&&(this.stop=!0,this.ignoreUnload=!0,r.info("swipe limit reached for basic users, stopping auto swiper")),this.site.profileCard=this.getProfileCard(),this.stop){r.info("Auto swiper stopped, exiting check");return}if(!this.site.profileCard){r.warn("No profile card found, skipping check");return}if(this.site.profileCard)if(this.site.supportRandomUsageSimulation&&this.options.enableRandomUsageSimulation&&this.randomUsageCounter<=this.radnomUsageNumber){this.randomUsageCounter++,r.debug("Random usage simulation triggered"),this.site.doRandomUsageSimulation();return}else this.randomUsageCounter=0;await this.loadProfileData(),r.debug("Profile data loaded",{name:this.profile.name,age:this.profile.age,distance:this.profile.distance,photosCount:this.profile.photosCount,verifyed:this.profile.verifyed,description:this.profile.description?this.profile.description.substring(0,100)+"...":"No description",height:this.profile.height}),r.debug("Verification settings",{onlyVerifyedProfiles:this.options.onlyVerifyedProfiles,siteName:this.site.getSiteName(),subscriptionLevel:{isBasic:this.options.isBasic,isPro:this.options.isPro,isUltimate:this.options.isUltimate}});const e=(t,s)=>t?.name===s?.name&&t?.age===s?.age&&t?.distance===s?.distance&&t?.photosCount===s?.photosCount&&t?.description===s?.description&&t?.texts===s?.texts&&t?.verifyed===s?.verifyed;if(this.cardTries.lastProfile&&e(this.profile,this.cardTries.lastProfile)&&this.cardTries.lastLastProfile&&e(this.cardTries.lastProfile,this.cardTries.lastLastProfile)){r.warn("Same profile detected three times in a row, handling..."),this.sameProfileFound();return}else this.cardTries.sameProfileFoundCounter=0;if(this.options.forceMatch&&(this.options.isPro||this.options.isUltimate)){if(r.debug("Forced Match Mode - Progress",{forcedMatchProgress:this.forcedMatchProgress}),this.forcedMatchProgress.left===!1){r.info("DECISION: Force Match - Swiping LEFT (required for force match)"),this.profile.reason="Force Match - Required Left Swipe",this.swipeLeft(),this.forcedMatchProgress.left=!0;return}if(this.forcedMatchProgress.right===!1){r.info("DECISION: Force Match - Swiping RIGHT (required for force match)"),this.profile.reason="Force Match - Required Right Swipe",this.swipeRight(),this.forcedMatchProgress.right=!0;return}this.forcedMatchProgress.left===!0&&this.forcedMatchProgress.right===!0&&(this.forcedMatchProgress.left=!1,this.forcedMatchProgress.right=!1,this.ignoreUnload=!0,r.info("Force Match complete - reloading tab"),m.clearSession(),r.debug("Content: Cleared session backup before intentional reload"),r.debug("sent: auto-swiper-message-backgroundjs-reload-tab"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-reload-tab",swipeCounts:this.swipeCounts,options:this.options,swipeLog:this.options.swipeLog,tabId:this.options.tabId,cardTries:this.cardTries}))}if((this.options.isBasic||this.options.isPro||this.options.isUltimate)&&this.options.enableLeftSwipesPercentageFilter){if(this.nextSwipes?.length>0)return this.nextSwipes.shift()==="left"?(r.info("DECISION: Left Swipe Percentage Filter - predetermined left swipe"),this.profile.reason=c.i18n.getMessage("LEFT_SWIPES_PERCENTAGE"),this.swipeLeft()):(r.info("DECISION: Left Swipe Percentage Filter - predetermined right swipe"),this.profile.reason="Left Swipe Percentage Filter - Right Swipe",this.swipeRight());{let t=this.getRandom(this.options.leftSwipePercentage[0],this.options.leftSwipePercentage[1]);r.debug("Generating left swipe percentage for the next 100 swipes",{leftSwipesCount:t+"%"});let s=100-t,o=[];for(let n=1;n<=t;n++)o.push("left");let i=[];for(let n=1;n<=s;n++)i.push("right");this.nextSwipes=this.distributeSwipesEvenly(o,i),r.debug("Swipe sequence generated, restarting check");return}}if(r.debug("Profile Text",{texts:this.profile.texts}),this.options.bannedWords?.length>0){r.debug("Checking banned words filter",{bannedWordsEnabled:!0,bannedWordsList:this.options.bannedWords});let t=this.getBannedWords();if(t?.length>0)return r.info("DECISION: BANNED WORDS FOUND - Swiping LEFT",{foundBannedWords:t,profileTexts:this.profile.texts}),this.profile.reason=c.i18n.getMessage("REASON_BANNED_WORD")+" = "+t.join(", "),this.swipeLeft();r.debug("Banned words check passed - no banned words found")}else r.debug("Banned words filter disabled");if(this.options.enablePreferredWordsFilter&&(this.options.isBasic||this.options.isPro||this.options.isUltimate)&&this.options.preferredWords?.length>0){r.debug("Content: üîç Checking preferred words filter",{preferredWordsEnabled:!0,preferredWordsList:this.options.preferredWords});let t=this.getPreferredWords();if(t?.length>0)return r.info("Content: ‚û°Ô∏è DECISION: PREFERRED WORDS FOUND - Instant RIGHT swipe",{foundPreferredWords:t,profileTexts:this.profile.texts}),this.profile.reason="Preferred words found: "+t.join(", "),this.swipeRight();r.debug("Content: ‚ö™ Preferred words check - no preferred words found, continuing filters")}else r.debug("Content: ‚ö™ Preferred words filter disabled or not available for subscription level");if(this.options.enableAgeFilter){if(r.debug("Content: üîç Checking age filter",{ageFilterEnabled:!0,profileAge:this.profile.age,minAge:Math.min(this.options.minMaxAge[0],this.options.minMaxAge[1]),maxAge:Math.max(this.options.minMaxAge[0],this.options.minMaxAge[1])}),this.profile.age!==""&&this.profile.age<Math.min(this.options.minMaxAge[0],this.options.minMaxAge[1]))return r.info("Content: ‚¨ÖÔ∏è DECISION: AGE TOO YOUNG - Swiping LEFT",{profileAge:this.profile.age,minRequiredAge:Math.min(this.options.minMaxAge[0],this.options.minMaxAge[1])}),this.profile.reason=c.i18n.getMessage("REASON_TO_YOUNG"),this.swipeLeft();if(this.profile.age!==""&&this.profile.age>Math.max(this.options.minMaxAge[0],this.options.minMaxAge[1]))return r.info("Content: ‚¨ÖÔ∏è DECISION: AGE TOO OLD - Swiping LEFT",{profileAge:this.profile.age,maxAllowedAge:Math.max(this.options.minMaxAge[0],this.options.minMaxAge[1])}),this.profile.reason=c.i18n.getMessage("REASON_TO_OLD"),this.swipeLeft();r.debug("Content: ‚úÖ Age filter passed")}else r.debug("Content: ‚ö™ Age filter disabled");if(this.options.enableHeightFilter&&this.profile.height!==null){if(r.debug("Content: üîç Checking height filter",{heightFilterEnabled:!0,profileHeight:this.profile.height,minHeight:Math.min(this.options.minMaxHeight[0],this.options.minMaxHeight[1]),maxHeight:Math.max(this.options.minMaxHeight[0],this.options.minMaxHeight[1])}),this.profile.height!==""&&this.profile.height<Math.min(this.options.minMaxHeight[0],this.options.minMaxHeight[1]))return r.info("Content: ‚¨ÖÔ∏è DECISION: HEIGHT TOO SHORT - Swiping LEFT",{profileHeight:this.profile.height,minRequiredHeight:Math.min(this.options.minMaxHeight[0],this.options.minMaxHeight[1])}),this.profile.reason=c.i18n.getMessage("REASON_HEIGHT_TO_SMALL"),this.swipeLeft();if(this.profile.height!==""&&this.profile.height>Math.max(this.options.minMaxHeight[0],this.options.minMaxHeight[1]))return r.info("Content: ‚¨ÖÔ∏è DECISION: HEIGHT TOO TALL - Swiping LEFT",{profileHeight:this.profile.height,maxAllowedHeight:Math.max(this.options.minMaxHeight[0],this.options.minMaxHeight[1])}),this.profile.reason=c.i18n.getMessage("REASON_HEIGHT_TO_TALL"),this.swipeLeft();r.debug("Content: ‚úÖ Height filter passed")}else this.options.enableHeightFilter?r.debug("Content: ‚ö™ Height filter enabled but profile has no height data"):r.debug("Content: ‚ö™ Height filter disabled");if(this.site.getSiteName()!=="pof")if(this.options.enableMinPicturesFilter){if(r.debug("Content: üîç Checking minimum pictures filter",{minPicturesFilterEnabled:!0,profilePhotosCount:this.profile.photosCount,minRequiredPictures:this.options.minPictures}),this.profile.photosCount<this.options.minPictures)return r.info("Content: ‚¨ÖÔ∏è DECISION: TOO FEW PICTURES - Swiping LEFT",{profilePhotosCount:this.profile.photosCount,minRequiredPictures:this.options.minPictures}),this.profile.reason=c.i18n.getMessage("REASON_TO_LESS_PICTURES"),this.swipeLeft();r.debug("Content: ‚úÖ Minimum pictures filter passed")}else r.debug("Content: ‚ö™ Minimum pictures filter disabled");else r.debug("Content: ‚ö™ Minimum pictures filter skipped (PoF site)");if(this.options.enableDistanceFilter)if(r.debug("Content: üîç Checking distance filter",{distanceFilterEnabled:!0,profileDistance:this.profile.distance,maxAllowedDistance:this.options.maxDistance,skipEmptyDistance:this.options.skipEmptyDistance}),this.options.maxDistance!==0&&this.profile.distance>this.options.maxDistance)if(this.options.skipEmptyDistance&&this.profile.distance===5e5)r.debug("Content: ‚ö™ Distance filter - skipping empty distance (500000km indicates no distance data)");else return r.info("Content: ‚¨ÖÔ∏è DECISION: TOO FAR AWAY - Swiping LEFT",{profileDistance:this.profile.distance,maxAllowedDistance:this.options.maxDistance}),this.profile.reason=c.i18n.getMessage("REASON_TO_FAR_AWAY")+" "+this.profile.distance+" Distance",this.swipeLeft();else r.debug("Content: ‚úÖ Distance filter passed");else r.debug("Content: ‚ö™ Distance filter disabled");if(this.options.isBasic||this.options.isPro||this.options.isUltimate){if(this.profile?.description?.length===0&&this.options.noEmptyDescription)return r.debug("Content: üîç Checking empty description filter",{noEmptyDescriptionEnabled:this.options.noEmptyDescription,profileDescriptionLength:this.profile?.description?.length||0}),r.info("Content: ‚¨ÖÔ∏è DECISION: EMPTY DESCRIPTION - Swiping LEFT",{profileDescription:this.profile?.description||"No description",descriptionLength:this.profile?.description?.length||0}),this.profile.reason=c.i18n.getMessage("REASON_EMPTY_DESCRIPTION"),this.swipeLeft();if(this.options.noEmptyDescription?r.debug("Content: ‚úÖ Empty description filter passed - profile has description"):r.debug("Content: ‚ö™ Empty description filter disabled"),this.site.getSiteName()==="tinder"||this.site.getSiteName()==="bumble"||this.site.getSiteName()==="lovoo"){if(r.debug("Content: üîç Checking verified profiles filter",{siteName:this.site.getSiteName(),onlyVerifyedProfilesEnabled:this.options.onlyVerifyedProfiles,profileVerifyed:this.profile.verifyed,profileVerifyedType:typeof this.profile.verifyed,profileVerifyedString:String(this.profile.verifyed),subscriptionLevel:{isBasic:this.options.isBasic,isPro:this.options.isPro,isUltimate:this.options.isUltimate}}),!this.profile.verifyed&&this.options.onlyVerifyedProfiles)return r.info("Content: ‚¨ÖÔ∏è DECISION: NOT VERIFIED - Swiping LEFT",{profileVerifyed:this.profile.verifyed,onlyVerifyedProfilesEnabled:this.options.onlyVerifyedProfiles,siteName:this.site.getSiteName(),debugInfo:{"this.profile.verifyed":this.profile.verifyed,"!this.profile.verifyed":!this.profile.verifyed,"this.options.onlyVerifyedProfiles":this.options.onlyVerifyedProfiles,"condition result":!this.profile.verifyed&&this.options.onlyVerifyedProfiles}}),this.profile.reason=c.i18n.getMessage("REASON_ONLY_VERIFYED_PROFILES"),this.swipeLeft();this.options.onlyVerifyedProfiles?r.debug("Content: ‚úÖ Verified profiles filter passed - profile is verified"):r.debug("Content: ‚ö™ Verified profiles filter disabled")}else r.debug("Content: ‚ö™ Verified profiles filter not applicable for site",{siteName:this.site.getSiteName()});if(this.site.getSiteName()==="tinder")if(this.options.onlyRecentlyActive){const t=this.site.getRecentlyActive();if(r.debug("Content: üîç Checking recently active filter",{onlyRecentlyActiveEnabled:this.options.onlyRecentlyActive,profileRecentlyActive:t}),t)r.debug("Content: ‚úÖ Recently active filter passed");else return r.info("Content: ‚¨ÖÔ∏è DECISION: NOT RECENTLY ACTIVE - Swiping LEFT",{profileRecentlyActive:t,onlyRecentlyActiveEnabled:this.options.onlyRecentlyActive}),this.profile.reason=c.i18n.getMessage("REASON_ONLY_RECENTLY_ACTIVE"),this.swipeLeft()}else r.debug("Content: ‚ö™ Recently active filter disabled");else r.debug("Content: ‚ö™ Recently active filter not applicable for site",{siteName:this.site.getSiteName()})}else r.debug("Content: ‚ö™ Premium filters skipped - not available for free subscription");if((this.options.isBasic||this.options.isPro||this.options.isUltimate)&&this.options.requiredWords?.length>0){r.debug("Content: üîç Checking required words filter",{requiredWordsEnabled:!0,requiredWordsList:this.options.requiredWords});let t=this.getRequiredWords();if(r.debug("Content: üìù Required words found in profile",{requiredWords:t}),t?.length<1)return r.info("Content: ‚¨ÖÔ∏è DECISION: REQUIRED WORDS NOT FOUND - Swiping LEFT",{requiredWordsList:this.options.requiredWords,foundRequiredWords:t,profileTexts:this.profile.texts}),this.profile.reason=c.i18n.getMessage("REASON_REQUIRED_WORD"),this.swipeLeft();r.debug("Content: ‚úÖ Required words filter passed",{foundRequiredWords:t})}else r.debug("Content: ‚ö™ Required words filter disabled or not available for subscription level");return r.info("Content: ‚û°Ô∏è DECISION: ALL FILTERS PASSED - Swiping RIGHT",{profileName:this.profile.name,summary:"Profile passed all enabled filters"}),this.profile.reason="All filters passed",this.swipeRight()}sendProgressUpdateAutoSwipe(){let e=this;try{r.debug("Content: sent auto-swiper-message-popupjs-progress-update",{swipeCounts:e.swipeCounts,profile:{name:e.profile.name,age:e.profile.age}}),c.runtime.sendMessage({action:"auto-swiper-message-popupjs-progress-update",swipeCounts:e.swipeCounts,profile:e.profile})}catch(t){r.error("Content: Error on sending auto-swiper-message-popupjs-progress-update",{error:t.message})}}sendDonAutoSwipe(){let e=this;if((this.options.isFree||this.options.isBasic)&&c.storage.local.set({lastSwipeCount:e.swipeCounts.total}),c.storage.local.set({swipeLog:e.options.swipeLog,stats:e.options.stats}),r.info("Content: sent auto-swiper-message-popupjs-done",{swipeCounts:this.swipeCounts,sessionDuration:this.sessionEndedAt-this.sessionStartedAt}),c.runtime.sendMessage({action:"auto-swiper-message-popupjs-done",swipeCounts:e.swipeCounts,site:this.site.getSiteName()}),r.debug("Content: sent auto-swiper-message-backgroundjs-stopped"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-stopped",tabId:this.options.tabId}),this.addSessionToApi(),!this.userStopped&&this.options.withNotification){let t=c.i18n.getMessage("BROWSER_NOTIFICATION_DON_TEXT")+" "+c.i18n.getMessage("LEFT")+": "+this.swipeCounts.left+" "+c.i18n.getMessage("RIGHT")+": "+this.swipeCounts.right+" "+c.i18n.getMessage("TOTAL")+": "+(this.swipeCounts.left+this.swipeCounts.right);r.debug("Content: sent auto-swiper-message-backgroundjs-send-notification",{percentageRight}),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-send-notification",message:t})}}async startSwiping(){W();try{const e=m.getSession();if(e){r.info("Content: Found previous session backup, attempting to send",{sessionId:e.sessionId,site:e.site,swipeCount:e.swipeCounts?.total||0});const s={loginToken:(await c.storage.local.get(["loginToken"])).loginToken||null,uuid:this.options.uuid,isFree:this.options.isFree};await m.checkAndSendBackup(s),r.info("Content: Previous session sent successfully")}}catch(e){if(r.error("Content: Could not send previous session, aborting new session start",{error:e.message}),m.clearOldBackupIfStuck())r.warn("Content: Cleared stuck backup, retrying session start");else return}if(this.sessionStartedAt=this.formatDateTime(new Date),!this.options.sessionId){const e=await this.startSessionOnApi();if(e)this.options.sessionId=e,r.info("Session started with unified approach",{sessionId:e});else throw r.error("Failed to start session - cannot proceed without session ID"),new Error("Session start failed - no session ID returned")}r.debug("Content: sent auto-swiper-message-backgroundjs-start-loop"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-start-loop",options:this.options,siteSwipeSpeedModifier:this.site.getSwipeSpeedModifier()})}stopSwiping(){this.sessionEndedAt=this.formatDateTime(new Date),r.debug("Content: sent auto-swiper-message-backgroundjs-stop-loop"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-stop-loop"})}async checkLoop(){const e=this;e.resetProfile(),setTimeout(async()=>{await e.check(),e.sendProgressUpdateAutoSwipe(),e.stop===!1?e.options.enableAutomaticPageReload&&e.swipeCount===e.reloadPageAtSwipes&&e.options.forceMatch===!1?(e.ignoreUnload=!0,m.clearSession(),r.debug("Content: Cleared session backup before intentional reload"),r.warn("Content: sent auto-swiper-message-backgroundjs-reload-tab",{swipeCounts:e.swipeCounts,reloadPageAtSwipes:e.reloadPageAtSwipes}),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-reload-tab",swipeCounts:e.swipeCounts,options:e.options,swipeLog:e.options.swipeLog,tabId:e.options.tabId,cardTries:e.cardTries})):e.options.enableBreak&&e.swipeCount===e.breakAtSwipes&&(r.info("Content: initiate break",{breakDuration:e.breakDuration,unit:"minutes"}),e.stop=!0,e.stopSwiping(),r.debug("Content: sent auto-swiper-message-backgroundjs-create-restart-alarm",{breakDuration:e.breakDuration}),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-create-restart-alarm",options:e.options,swipeCounts:e.swipeCounts,cardTries:e.cardTries,breakDuration:e.breakDuration})):(e.stopSwiping(),e.sendDonAutoSwipe())},1e3)}}let h=null;const Ce=function(a){r.warn("Content: beforeunload event triggered"),h&&!h.ignoreUnload&&(r.warn("Content: unload event triggered and request check"),a.returnValue="Are you sure you want to stop Auto Swiper?")},Ae=function(a){if(h&&!h.ignoreUnload){h.stop=!0,h.ignoreUnload=!0,r.warn("Content: unload event triggered, stopping auto swiper");try{if(h.sessionStartedAt){const e=m.createSessionData(h,"pending");m.saveSession(e),r.info("Content: Emergency session backup saved on unload")}}catch(e){r.error("Content: Failed to save emergency backup on unload",{error:e.message})}h.sendDonAutoSwipe()}};addEventListener("beforeunload",Ce.bind(void 0),{capture:!0}),addEventListener("unload",Ae.bind(void 0),{capture:!0}),c.runtime.onMessage.addListener(function(a,e,t){if(a.action==="auto-swiper-message-contentjs-ping"){r.debug("Content script received ping, sending response");try{t({status:"ok"}),r.debug("Content script sent response successfully")}catch(s){r.error("Error sending response",{error:s.message})}return!0}a.action==="auto-swiper-message-contentjs-start"&&(r.info("Content: received auto-swiper-message-contentjs-start"),h=new oe(a.options),h.startSwiping()),a.action==="auto-swiper-message-contentjs-start-after-tab-reload"&&(r.info("Content: received auto-swiper-message-contentjs-start-after-tab-reload"),h=new oe(a.options),h.swipeCounts=a.swipeCounts,h.cardTries=a.cardTries,h.lastSessionUpdate=h.swipeCounts.total,r.debug("Content: cardTries restored",{cardTries:h.cardTries}),h.ignoreUnload=!1,h.stop=!1,h.startSwiping()),a.action==="auto-swiper-message-contentjs-restart"&&(r.info("Content: received auto-swiper-message-contentjs-restart"),h.stop=!1,h.ignoreUnload=!1,h.regenerateRandomSettings(),h.breakAtSwipes+=h.swipeCount,h.startSwiping()),a.action==="auto-swiper-message-contentjs-stop"&&(r.info("Content: received auto-swiper-message-contentjs-stop"),h.stop=!0,h.userStopped=!0,h.ignoreUnload=!0),a.action==="auto-swiper-message-contentjs-check-progress"&&(r.debug("Content: received auto-swiper-message-contentjs-check-progress"),h&&h.stop===!1&&h.sendProgressUpdateAutoSwipe()),a.action==="auto-swiper-message-contentjs-check-loop"&&(r.debug("Content: received auto-swiper-message-contentjs-check-loop"),h&&h.checkLoop()),a.action==="auto-swiper-message-contentjs-ignore-unload"&&(r.debug("Content: received auto-swiper-message-contentjs-ignore-unload"),h&&(h.ignoreUnload=!0)),t()}),r.info("auto-swiper-content.js loaded"),setTimeout(function(){r.info("Content: sent auto-swiper-message-backgroundjs-loaded"),c.runtime.sendMessage({action:"auto-swiper-message-backgroundjs-loaded"})},2500)})();
